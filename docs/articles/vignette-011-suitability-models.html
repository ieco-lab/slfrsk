<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>vignette-011-suitability-models • slfrsk</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="vignette-011-suitability-models">
<meta property="og:description" content="slfrsk">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slfrsk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">9999.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette-010-tidy-data.html">vignette-010-tidy-data</a>
    </li>
    <li>
      <a href="../articles/vignette-011-suitability-models.html">vignette-011-suitability-models</a>
    </li>
    <li>
      <a href="../articles/vignette-021-quadrant-plots.html">vignette-021-quadrant-plots</a>
    </li>
    <li>
      <a href="../articles/vignette-030-risk-maps.html">vignette-030-risk-maps</a>
    </li>
    <li>
      <a href="../articles/vignette-040-ee-data.html">vignette-040-ee-data</a>
    </li>
    <li>
      <a href="../articles/vignette-041-market-plot.html">vignette-041-market-plot</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette-011-suitability-models_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>vignette-011-suitability-models</h1>
            
      
      
      <div class="hidden name"><code>vignette-011-suitability-models.Rmd</code></div>

    </div>

    
    
<p>How to Build, Evaluate, and Save Ecological Niche Models of Suitability for <em>Ailanthus altissima</em> (TOH) and <em>Lycorma delicatula</em> (SLF)</p>
<hr>
<p>This vignette is designed to demonstrate the workflow that lead to the creation of the three suitability models used to assess the risk of <em>Lycorma</em> paninvasion. The description will not include actual running of some steps of this workflow, as some are unwieldy. Instead, information to ensure proper replication of those steps is provided. Notably, the maxent runs are not conducted in this vignette, although the means to do so within <code>R</code> may be possible.</p>
<p>The scope of this vignette is as follows:</p>
<ol style="list-style-type: decimal">
<li>Reading and Visualization of Presence Data</li>
<li>Preparation of Spatial Data</li>
<li>Evaluation of Spatial Data Collinearity</li>
<li>Building and evaluating Maxent SDMs for the three models</li>
<li>Conversion of Maxent Output from ASCII to GEOTIFF</li>
<li>Extraction of Summary Statistics by Geopolitical Unit from Maxent models</li>
</ol>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>We load the packages that are necessary to complete any analyses that allow us to demonstrate the workflow. Packages may include comments to clarify their purpose or the steps in which they are used.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">slfrsk</span>) <span class="co">#this package</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)  <span class="co">#data manipulation</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">here</span>) <span class="co">#making directory pathways easier on different instances</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ENMTools</span>) <span class="co">#enviro collinearity analyses</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">patchwork</span>) <span class="co">#easy combined plots</span></pre></body></html></div>
</div>
<div id="reading-and-visualization-of-presence-data" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-and-visualization-of-presence-data" class="anchor"></a>1. Reading and Visualization of Presence Data</h1>
<p>We built models of both SLF and TOH from presence records obtained from public and collaborator databases (queried 24-09-2018 and 26-09-2018, respectively; <span class="citation">Kim et al. (<a href="#ref-kim_molecular_2013" role="doc-biblioref">2013</a>)</span>, <span class="citation">GBIF (<a href="#ref-gbif_gbif:_2019" role="doc-biblioref">2019</a>)</span>). As is standard practice, we checked all records for quality, removed duplicate and imprecise records, and obtained 8,578 TOH and 145 SLF unique and cleaned presence records.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">#load data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"slf_points"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"toh_points"</span>)

<span class="co">#plot points on map: TOH</span>
<span class="no">map_toh</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>() +
  <span class="fu">geom_polygon</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu">map_data</span>(<span class="st">'world'</span>), <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">long</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">lat</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">group</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"#778899"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">0.15</span>) + <span class="co">#world map</span>
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">toh_points</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>), <span class="kw">color</span> <span class="kw">=</span> <span class="st">"blue"</span>) +
  <span class="fu">theme_bw</span>() +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">""</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">""</span>) +
  <span class="fu">theme</span>(<span class="kw">panel.grid.major</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.grid.minor</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.background</span> <span class="kw">=</span> <span class="fu">element_rect</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">"#6699cc"</span>)) +
  <span class="fu">coord_quickmap</span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">164.5</span>, <span class="fl">163.5</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">55</span>,<span class="fl">85</span>)) +
  <span class="fu">ggtitle</span>(<span class="kw">label</span> <span class="kw">=</span> <span class="st">"TOH Presence"</span>)

<span class="co">#plot points on map: SLF</span>
<span class="no">map_slf</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>() +
  <span class="fu">geom_polygon</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu">map_data</span>(<span class="st">'world'</span>), <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">long</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">lat</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">group</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"#778899"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">0.15</span>) + <span class="co">#world map</span>
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">slf_points</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>), <span class="kw">color</span> <span class="kw">=</span> <span class="st">"red"</span>) +
  <span class="fu">theme_bw</span>() +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">""</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">""</span>) +
  <span class="fu">theme</span>(<span class="kw">panel.grid.major</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.grid.minor</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.background</span> <span class="kw">=</span> <span class="fu">element_rect</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">"#6699cc"</span>)) +
  <span class="fu">coord_quickmap</span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">164.5</span>, <span class="fl">163.5</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">55</span>,<span class="fl">85</span>)) +
  <span class="fu">ggtitle</span>(<span class="kw">label</span> <span class="kw">=</span> <span class="st">"SLF Presence"</span>)

<span class="co">#patchwork output of both maps</span>
<span class="no">map_toh</span> / <span class="no">map_slf</span></pre></body></html></div>
<p><img src="vignette-011-suitability-models_files/figure-html/read%20in%20presence%20records%20and%20show%20on%20a%20quick%20map-1.png" width="960"></p>
</div>
<div id="preparation-of-spatial-data" class="section level1">
<h1 class="hasAnchor">
<a href="#preparation-of-spatial-data" class="anchor"></a>2. Preparation of Spatial Data</h1>
<p>To discern which environmental variables to use in the species distribution models (SDMs), we had to minimize collinearity among included covariates (<span class="citation">Peterson et al. (<a href="#ref-peterson_ecological_2011" role="doc-biblioref">2011</a>)</span>). To do so, we estimated pairwise correlation coefficients for 22 global raster covariates hypothesized to influence SLF and TOH distributions: the 20 WorldClim topographic and bioclimatic variables (<span class="citation">Hijmans et al. (<a href="#ref-hijmans_very_2005" role="doc-biblioref">2005</a>)</span>, <span class="citation">Fick and Hijmans (<a href="#ref-fick_worldclim_2017" role="doc-biblioref">2017</a>)</span>), forest height (<span class="citation">Simard et al. (<a href="#ref-simard_mapping_2011" role="doc-biblioref">2011</a>)</span>), and access to cities (<span class="citation">Weiss et al. (<a href="#ref-weiss_global_2018" role="doc-biblioref">2018</a>)</span>).</p>
<p>For tractability of modeling at a global scale, we first downsized the resolution of these covariate rasters with <code><a href="https://rdrr.io/pkg/raster/man/aggregate.html">raster::aggregate(fact = 2, fun = mean, expand = TRUE, na.rm = TRUE)</a></code> and cropped their extent to <span class="math inline">\([-180, 180]\)</span> for latitude and <span class="math inline">\([-60, 84]\)</span> for longitude.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">#WRITING CHUNKS TO HOLD
#We fit these covariates combined to SLF and TOH presences, but BIO02 and ELEV explained &lt;1.0% of the variation, so we removed these two covariates and refit the remaining covariates under default settings (v3.4.1) except for the availability of all model features and an applied threshold rule of "minimum training presence" (Phillips et al. 2006, Pearson et al. 2007). </pre></body></html></div>
<p>With the correlations, we identified 6 of the 22 covariates that had minimal cross-correlations: annual mean temperature (<strong>BIO01</strong>), mean diurnal temperature range (<strong>BIO02</strong>), annual precipitation (<strong>BIO12</strong>), precipitation seasonality (<strong>BIO15</strong>), elevation (<strong>ELEV</strong>), and access to cities (<strong>ATC</strong>).</p>
</div>
<div id="visualize-models" class="section level1">
<h1 class="hasAnchor">
<a href="#visualize-models" class="anchor"></a>Visualize Models</h1>
</div>
<div id="save-models" class="section level1">
<h1 class="hasAnchor">
<a href="#save-models" class="anchor"></a>Save Models</h1>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-fick_worldclim_2017">
<p>Fick, Stephen E., and Robert J. Hijmans. 2017. “WorldClim 2: New 1-Km Spatial Resolution Climate Surfaces for Global Land Areas: NEW CLIMATE SURFACES FOR GLOBAL LAND AREAS.” <em>International Journal of Climatology</em> 37 (12): 4302–15. <a href="https://doi.org/10.1002/joc.5086">https://doi.org/10.1002/joc.5086</a>.</p>
</div>
<div id="ref-gbif_gbif:_2019">
<p>GBIF. 2019. “GBIF: The Global Biodiversity Information Facility.” Public Database. <a href="https://www.gbif.org/">https://www.gbif.org/</a>.</p>
</div>
<div id="ref-hijmans_very_2005">
<p>Hijmans, Robert J., Susan E. Cameron, Juan L. Parra, Peter G. Jones, and Andy Jarvis. 2005. “Very High Resolution Interpolated Climate Surfaces for Global Land Areas.” <em>International Journal of Climatology</em> 25 (15): 1965–78. <a href="https://doi.org/10.1002/joc.1276">https://doi.org/10.1002/joc.1276</a>.</p>
</div>
<div id="ref-kim_molecular_2013">
<p>Kim, Hyojoong, Min-Young Kim, Deok Ho Kwon, Sangwook Park, Yerim Lee, Junhao Huang, Shi Kai, et al. 2013. “Molecular Comparison of Lycorma Delicatula (Hemiptera: Fulgoridae) Isolates in Korea, China, and Japan.” <em>Journal of Asia-Pacific Entomology</em> 16 (4): 503–6.</p>
</div>
<div id="ref-peterson_ecological_2011">
<p>Peterson, A Townsend, Jorge Soberón, Richard G Pearson, Robert P Anderson, Enrique Martínez-Meyer, Miguel Nakamura, and Miguel B Araújo. 2011. <em>Ecological Niches and Geographic Distributions</em>. Princeton University Press.</p>
</div>
<div id="ref-simard_mapping_2011">
<p>Simard, Marc, Naiara Pinto, Joshua B. Fisher, and Alessandro Baccini. 2011. “Mapping Forest Canopy Height Globally with Spaceborne Lidar.” <em>Journal of Geophysical Research: Biogeosciences</em> 116 (G4). <a href="https://doi.org/10.1029/2011JG001708">https://doi.org/10.1029/2011JG001708</a>.</p>
</div>
<div id="ref-weiss_global_2018">
<p>Weiss, D. J., A. Nelson, H. S. Gibson, W. Temperley, S. Peedell, A. Lieber, M. Hancher, et al. 2018. “A Global Map of Travel Time to Cities to Assess Inequalities in Accessibility in 2015.” <em>Nature</em> 553 (7688): 333–36. <a href="https://doi.org/10.1038/nature25181">https://doi.org/10.1038/nature25181</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by M.R. Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
