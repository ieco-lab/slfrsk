<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invasion Potential Alignment • slfrsk</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Invasion Potential Alignment">
<meta property="og:description" content="slfrsk">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slfrsk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vignette-001-overview.html">Overview</a>
</li>
<li>
  <a href="../articles/vignette-002-terms.html">Definitions</a>
</li>
<li>
  <a href="../articles/vignette-040-ee-data.html">Paninvasion Severity App</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Step 1: Estimate Invasion Potentials</a>
      <ul class="dropdown-menu" role="menu">
<li class="divider">
        <li>
          <a href="../articles/vignette-003-get-gbif-data.html">Get GBIF Records</a>
        </li>
        <li>
          <a href="../articles/vignette-010-tidy-data.html">Data Tidying</a>
        </li>
        <li>
          <a href="../articles/vignette-011-suitability-models.html">Species Distribution Modeling</a>
        </li>
        <li class="divider">
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Step 2: Calculate Alignment Correlations</a>
      <ul class="dropdown-menu" role="menu">
<li class="divider">
        <li>
          <a href="../articles/vignette-030-potentials-maps.html">Invasion Potential Maps</a>
        </li>
        <li class="dropdown-submenu">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Invasion Potential Alignment</a>
          <ul class="dropdown-menu" role="menu">
<li class="divider">
            <li>
              <a href="../articles/vignette-021-quadrant-plots.html">Published (Max)</a>
            </li>
            <li>
              <a href="../articles/vignette-026-quadrant-plots-alt-median.html">Alternate (Median)</a>
            </li>
            <li>
              <a href="../articles/vignette-027-quadrant-plots-alt-mean.html">Alternate (Mean)</a>
            </li>
            <li class="divider">
          </ul>
</li>
        <li class="divider">
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Step 3: Quantify Paninvasion Severity</a>
      <ul class="dropdown-menu" role="menu">
<li class="divider">
        <li>
          <a href="../articles/vignette-041-market-plot.html">Paninvasion Severity</a>
        </li>
        <li class="divider">
      </ul>
</li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ieco-lab/slfrsk">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette-021-quadrant-plots_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="vignette-021-quadrant-plots_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="vignette-021-quadrant-plots_files/plotly-binding-4.9.2.1/plotly.js"></script><script src="vignette-021-quadrant-plots_files/typedarray-0.1/typedarray.min.js"></script><script src="vignette-021-quadrant-plots_files/jquery-1.11.3/jquery.min.js"></script><link href="vignette-021-quadrant-plots_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="vignette-021-quadrant-plots_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="vignette-021-quadrant-plots_files/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="vignette-021-quadrant-plots_files/plotly-main-1.52.2/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Invasion Potential Alignment</h1>
            
      
      
      <div class="hidden name"><code>vignette-021-quadrant-plots.Rmd</code></div>

    </div>

    
    
<p>Build and Save Risk Correlation Quadrant Plots (Ensemble Extracts)</p>
<hr>
<p>This vignette visualizes the <strong>Introduction, Establishment, and Impact</strong> potentials in a plot together for U.S. states or countries. There are a few set-up and modifications steps that can be modified in the <code>.Rmd</code> itself before rendering the vignette.</p>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>To produce the published correlation figures, we must first conduct a few setup steps. First, we read in the appropriate data and packages.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">slfrsk</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">here</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggrepel</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">grid</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gridExtra</span>) <span class="co">#only needed if one uses grid.arrange() in plotting</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">plotly</span>) <span class="co">#interactive corplot</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scales</span>) <span class="co">#make custom tranform object for plotly corplots</span></pre></body></html></div>
<div id="toggle-data-partitions" class="section level2">
<h2 class="hasAnchor">
<a href="#toggle-data-partitions" class="anchor"></a>Toggle data partitions</h2>
<p>Secondarily, we confirm the particular partitions of data we intend to visualize (defaults match the published figures). Here is where one could change the version of data for the correlation figure via the following:</p>
<ol style="list-style-type: decimal">
<li>one_zero: Scale <strong>Transportation</strong> potential to be bounded <span class="math inline">\([0,1]\)</span>?
<ul>
<li>default is <code>TRUE</code>
</li>
</ul>
</li>
<li>present_transport: Use <code>present</code> or <code>future</code> infected U.S. states?
<ul>
<li>default is <code>TRUE</code> for <code>present</code>
</li>
</ul>
</li>
<li>method_cor: Which type of multiple correlation to calculate?
<ul>
<li>default is <code>"spearman"</code> (but see <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> documentation for more information)</li>
</ul>
</li>
<li>impact_prod: Which <strong>Impact</strong> potential product to evaluate?
<ul>
<li>default is <code>"grapes"</code> but can also look at <code>"wine"</code>
</li>
</ul>
</li>
<li>native: Plot the <code>countries</code> that have native <em>Lycorma</em> in the <code>countries</code> plot?
<ul>
<li>default is <code>TRUE</code>
</li>
</ul>
</li>
<li>rem_usa: Remove the “United States” from the <code>countries</code> plot?
<ul>
<li>default is <code>TRUE</code>
</li>
</ul>
</li>
</ol>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Make transport scaled between one and zero</span>
<span class="no">one_zero</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>

<span class="co"># switch between present or future transport</span>
<span class="no">present_transport</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>

<span class="co"># Set what type of multiple correlation to calculate</span>
<span class="no">method_cor</span> <span class="kw">&lt;-</span> <span class="st">"spearman"</span>

<span class="co"># set whether to look at grape or wine production (PLOT LABELS ARE NOT CLEAN FOR WINE!!!)</span>
<span class="co">#impact_prod &lt;- "wine"</span>
<span class="no">impact_prod</span> <span class="kw">&lt;-</span> <span class="st">"grapes"</span>

<span class="co"># Plot the native countries?</span>
<span class="no">native</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>

<span class="co"># remove USA?</span>
<span class="no">rem_usa</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>

<span class="co"># NONFUNCTIONAL---Replace this with max mean quantile_0.50 quantile_0.75 quantile_0.90 to edit which metric to plot for establishment</span>
<span class="co">#to run this, one needs to use different extract data sources further back in the cleaning process (vig01) by selecting a different variable</span>
<span class="co">#estab_to_plot &lt;- "max" # max was used for the quadrant figures</span></pre></body></html></div>
</div>
<div id="read-in-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-in-data" class="anchor"></a>Read in data</h2>
<p>We now load the summary data from <code>vignette-010-tidy-data</code>. Both <code>states</code> and <code>countries</code> data are loaded.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">  <span class="co">#data("states_summary_present")</span>
  <span class="co">#data("countries_summary_present")</span>
  <span class="co">#data("states_summary_future")</span>
  <span class="co">#data("countries_summary_future")</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"states_summary_present_ensemble"</span>)
    <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"countries_summary_present_ensemble"</span>)
    <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"states_summary_future_ensemble"</span>)
    <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"countries_summary_future_ensemble"</span>)

  <span class="no">states_summary_present</span> <span class="kw">&lt;-</span>  <span class="no">states_summary_present_ensemble</span>
  <span class="no">countries_summary_present</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present_ensemble</span>
  <span class="no">states_summary_future</span> <span class="kw">&lt;-</span>  <span class="no">states_summary_future_ensemble</span>
  <span class="no">countries_summary_future</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future_ensemble</span>

  <span class="co">#filter out some No Data for ensemble model</span>
  <span class="no">countries_summary_future</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Antarctica"</span>, <span class="st">"Monaco"</span>, <span class="st">"Norfolk Island"</span>, <span class="st">"Spratly Islands"</span>))
  <span class="no">countries_summary_present</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Antarctica"</span>, <span class="st">"Monaco"</span>, <span class="st">"Norfolk Island"</span>, <span class="st">"Spratly Islands"</span>))</pre></body></html></div>
<p><strong>NATIVE</strong>—If <em>Lycorma</em>-native countries can be coded as <code>native</code> or <code>not established</code> (not “invaded”) for plotting purposes with the <code>native</code> setting above.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="kw">if</span>(<span class="no">native</span>){
  <span class="no">countries_summary_present</span>$<span class="no">status</span>[<span class="no">countries_summary_present</span>$<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Taiwan"</span>, <span class="st">"Vietnam"</span>)] <span class="kw">&lt;-</span> <span class="st">"native"</span>
  <span class="no">countries_summary_future</span>$<span class="no">status</span>[<span class="no">countries_summary_future</span>$<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Taiwan"</span>, <span class="st">"Vietnam"</span>)] <span class="kw">&lt;-</span> <span class="st">"native"</span>
} <span class="kw">else</span> {
  <span class="no">countries_summary_present</span>$<span class="no">status</span>[<span class="no">countries_summary_present</span>$<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Taiwan"</span>, <span class="st">"Vietnam"</span>)] <span class="kw">&lt;-</span> <span class="st">"not established"</span>
  <span class="no">countries_summary_future</span>$<span class="no">status</span>[<span class="no">countries_summary_future</span>$<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Taiwan"</span>, <span class="st">"Vietnam"</span>)] <span class="kw">&lt;-</span> <span class="st">"not established"</span>
  }</pre></body></html></div>
<p><strong><code>states</code> SCALING</strong>—Even though a column in the <code>states</code> data does include the <span class="math inline">\(log_{10}(value+1)\)</span> transformation of <strong>transport</strong> potential, the mass of trade with infected states (<code>log10_avg_infected_mass</code>), the raw data were <span class="math inline">\(log_{10}(value+1)\)</span> transformed and then further rescaled (see <code>one_zero</code> above) as <code>avg_infected_mass_scaled</code>. The <strong>establishment</strong> potential is already scaled the same [0,1], but we create a new column of its values with the same <code>_scaled</code> suffix.</p>
<p>If <code>one_zero &lt;- FALSE</code>, then <strong>transport</strong> potential is just <span class="math inline">\(log_{10}(value+1)\)</span> transformed instead.</p>
<p><em>Please note that <code>states</code> and <code>countries</code> rescaling are done separately, as the latter has several rows that lack trade data (e.g., <code>NA</code>).</em></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># scale the import data</span>

<span class="kw">if</span>(<span class="no">one_zero</span>){
  <span class="no">states_summary_present</span> <span class="kw">&lt;-</span> <span class="no">states_summary_present</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> (<span class="no">avg_infected_mass_scaled</span> - <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">avg_infected_mass_scaled</span>))) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span> / <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">avg_infected_mass_scaled</span>)) <span class="kw">%&gt;%</span>
    <span class="co"># establishment</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">grand_mean_max_scaled</span> <span class="kw">=</span> <span class="no">grand_mean_max</span>)
  <span class="co"># mutate(grand_mean_max_scaled = (grand_mean_max - min(grand_mean_max))) %&gt;%</span>
  <span class="co"># mutate(grand_mean_max_scaled = grand_mean_max_scaled / max(grand_mean_max_scaled))</span>
  <span class="no">states_summary_future</span> <span class="kw">&lt;-</span> <span class="no">states_summary_future</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> (<span class="no">avg_infected_mass_scaled</span> - <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">avg_infected_mass_scaled</span>))) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span> / <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">avg_infected_mass_scaled</span>)) <span class="kw">%&gt;%</span>
    <span class="co"># establishment</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">grand_mean_max_scaled</span> <span class="kw">=</span> <span class="no">grand_mean_max</span>)
} <span class="kw">else</span> {
  <span class="no">states_summary_present</span> <span class="kw">&lt;-</span> <span class="no">states_summary_present</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="co"># %&gt;%</span>
    <span class="co"># establishment</span>
  <span class="no">states_summary_future</span> <span class="kw">&lt;-</span> <span class="no">states_summary_future</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>))
}</pre></body></html></div>
<p><strong><code>countries</code> REMOVAL</strong>—For the <code>countries</code> analysis, several countries in the actual dataset are not informative (usually due to lack of trade with the infected states or <code>NA</code> reported). If <code>rem_usa &lt;- TRUE</code>, then the U.S. is also removed from the <code>countries</code> analyses. This is an important step, as the cou</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="kw">if</span>(<span class="no">rem_usa</span>){ <span class="co"># TRUE if you want to remove the USA</span>
  <span class="no">rems</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Akrotiri and Dhekelia"</span>
            ,<span class="st">"?land"</span>
            ,<span class="st">"American Samoa"</span>
            ,<span class="st">"Bouvet Island"</span>
            ,<span class="st">"British Indian Ocean Territory"</span>
            ,<span class="st">"Caspian Sea"</span>
            ,<span class="st">"Christmas Island"</span>
            ,<span class="st">"Clipperton Island"</span>
            ,<span class="st">"Cocos Islands"</span>
            ,<span class="st">"Falkland Islands"</span>
            ,<span class="st">"Faroe Islands"</span>
            ,<span class="st">"French Southern Territories"</span>
            ,<span class="st">"Heard Island and McDonald Islands"</span>
            ,<span class="st">"Mayotte"</span>
            ,<span class="st">"Northern Mariana Islands"</span>
            ,<span class="st">"Paracel Islands"</span>
            ,<span class="st">"Pitcairn Islands"</span>
            ,<span class="st">"Saint Pierre and Miquelon"</span>
            ,<span class="st">"Tokelau"</span>
            ,<span class="st">"United States Minor Outlying Islands"</span>
            ,<span class="st">"Wallis and Futuna"</span>
            ,<span class="st">"United States"</span>
            ,<span class="st">"Philippines"</span>)
} <span class="kw">else</span> {
  <span class="no">rems</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Akrotiri and Dhekelia"</span>
            ,<span class="st">"?land"</span>
            ,<span class="st">"American Samoa"</span>
            ,<span class="st">"Bouvet Island"</span>
            ,<span class="st">"British Indian Ocean Territory"</span>
            ,<span class="st">"Caspian Sea"</span>
            ,<span class="st">"Christmas Island"</span>
            ,<span class="st">"Clipperton Island"</span>
            ,<span class="st">"Cocos Islands"</span>
            ,<span class="st">"Falkland Islands"</span>
            ,<span class="st">"Faroe Islands"</span>
            ,<span class="st">"French Southern Territories"</span>
            ,<span class="st">"Heard Island and McDonald Islands"</span>
            ,<span class="st">"Mayotte"</span>
            ,<span class="st">"Northern Mariana Islands"</span>
            ,<span class="st">"Paracel Islands"</span>
            ,<span class="st">"Pitcairn Islands"</span>
            ,<span class="st">"Saint Pierre and Miquelon"</span>
            ,<span class="st">"Tokelau"</span>
            ,<span class="st">"United States Minor Outlying Islands"</span>
            ,<span class="st">"Wallis and Futuna"</span>
            ,<span class="st">"Philippines"</span>)

}

<span class="co">#do the rm now</span>
<span class="no">countries_summary_present</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="no">rems</span>)
<span class="no">countries_summary_future</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="no">rems</span>)</pre></body></html></div>
<p><strong><code>countries</code> SCALING</strong>—Now that <code>countries</code> contains only rows of interest, we rescaled the <strong>transport</strong> potential as above for <code>states</code> and created the same <code>_scaled</code> data columns.</p>
<p>Now rescale countries as states</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># scale the import data</span>

<span class="kw">if</span>(<span class="no">one_zero</span>){

  <span class="no">countries_summary_present</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> (<span class="no">avg_infected_mass_scaled</span> - <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">avg_infected_mass_scaled</span>))) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span> / <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">avg_infected_mass_scaled</span>)) <span class="kw">%&gt;%</span>
    <span class="co"># establishment</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">grand_mean_max_scaled</span> <span class="kw">=</span> <span class="no">grand_mean_max</span>)
  <span class="co"># mutate(grand_mean_max_scaled = (grand_mean_max - min(grand_mean_max))) %&gt;%</span>
  <span class="co"># mutate(grand_mean_max_scaled = grand_mean_max_scaled / max(grand_mean_max_scaled))</span>

  <span class="no">countries_summary_future</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> (<span class="no">avg_infected_mass_scaled</span> - <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">avg_infected_mass_scaled</span>))) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span> / <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">avg_infected_mass_scaled</span>)) <span class="kw">%&gt;%</span>
    <span class="co"># establishment</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">grand_mean_max_scaled</span> <span class="kw">=</span> <span class="no">grand_mean_max</span>)

} <span class="kw">else</span> {

  <span class="no">countries_summary_present</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
    <span class="co"># establishment</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">grand_mean_max_scaled</span> <span class="kw">=</span> <span class="no">grand_mean_max</span>)

  <span class="no">countries_summary_future</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future</span> <span class="kw">%&gt;%</span>
    <span class="co"># transport</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
    <span class="co"># establishment</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">grand_mean_max_scaled</span> <span class="kw">=</span> <span class="no">grand_mean_max</span>)

}</pre></body></html></div>
<p><strong>Additional Note:</strong> Below is code that can be used to make a version of the <code>country</code> data that removes all countries that have a no <code>trade</code> with infected states (<em>we leave the zeroes in for the current figures</em>):</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="kw">if</span>(<span class="fl">FALSE</span>){
<span class="co">#rm the trade mass zero countries</span>
<span class="no">countries_summary_nozeros_present</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">log10_avg_infected_mass</span> <span class="kw">!=</span> <span class="fl">0</span>)
<span class="no">countries_summary_nozeros_future</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">log10_avg_infected_mass</span> <span class="kw">!=</span> <span class="fl">0</span>)

<span class="co">#rescale and log transform countries with the zeros for trade mass rm</span>
<span class="no">countries_summary_nozeros_present</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_nozeros_present</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> (<span class="no">avg_infected_mass_scaled</span>-<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">avg_infected_mass_scaled</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span>/<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">avg_infected_mass_scaled</span>))
<span class="no">countries_summary_nozeros_future</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_nozeros_future</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">avg_infected_mass</span>+<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> (<span class="no">avg_infected_mass_scaled</span>-<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">avg_infected_mass_scaled</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">avg_infected_mass_scaled</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span>/<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">avg_infected_mass_scaled</span>))
}</pre></body></html></div>
</div>
</div>
<div id="plotting" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h1>
<p>Now that the data have been prepared accordingly, plotting of the relationship among all three potentials can be visualized. For ease of viewing, we begin by setting a few plotting parameters before visualization.</p>
<div id="plotting-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-parameters" class="anchor"></a>Plotting parameters</h2>
<p>The following plotting parameters are set to produce the published figures but could be changed for plot customization:</p>
<ol style="list-style-type: decimal">
<li>label.countries.est: Label the countries that <em>Lycorma</em> has previously become established (Japan and South Korea) in the <code>countries</code> plot?
<ul>
<li>default is <code>TRUE</code>
</li>
</ul>
</li>
<li>label.states.est: Label the U.S. states that <em>Lycorma</em> has previously become established according to <code>present</code> or <code>future</code> scenarios in the <code>states</code> plot?
<ul>
<li>default is <code>TRUE</code>
</li>
<li>adds CT, DE, MD, NJ, OH, WV (all others already labeled)</li>
</ul>
</li>
<li>all nudge_* objects: custom settings for <code>geom_text_repel</code> starting positions of labels for the added countries or states. Within the major plotting chunk, one can change the nudging of the main plotted labels.</li>
</ol>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># label both of the countries (or states) with established SLF?</span>
<span class="no">label.countries.est</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>
<span class="no">label.states.est</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>   <span class="co">#same for both present/future: CT, DE, MD, NJ, OH, WV</span>
<span class="co"># labeling aesthetics for label.countries.est and label.states.est</span>
<span class="no">nudge_countries.est.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.05</span>,<span class="fl">0.05</span>)
<span class="no">nudge_countries.est.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.12</span>,<span class="fl">0.11</span>)
<span class="no">nudge_countries.est_future.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.05</span>,<span class="fl">0.05</span>)  <span class="co">#jpn and kor</span>
<span class="no">nudge_countries.est_future.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.12</span>,<span class="fl">0.11</span>)
<span class="no">nudge_states.est.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">0.00</span>, <span class="fl">0.00</span>, -<span class="fl">0.10</span>,  <span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.00</span>)  <span class="co">#adding OH, CT, DE, MD, NJ, WV</span>
<span class="no">nudge_states.est.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.10</span>, -<span class="fl">0.10</span>, <span class="fl">0.10</span>, -<span class="fl">0.17</span>,-<span class="fl">0.15</span>,-<span class="fl">0.10</span>)


<span class="co"># Choose quadrant intercepts</span>
<span class="no">q_intercepts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">transport</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">establishment</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="co">#set margins</span>
<span class="no">hh</span> <span class="kw">=</span> <span class="fl">.001</span>
<span class="co"># Do not change this flips between plotting the states or plotting countries</span>
<span class="no">plots_which</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">TRUE</span>,<span class="fl">FALSE</span>)
<span class="co"># How many countries and states to highlight for labels?</span>
<span class="no">top_to_plot</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="co">#color aesthetics</span>
<span class="no">risk_color</span> <span class="kw">&lt;-</span> <span class="st">"gray40"</span>
<span class="no">risk_size</span> <span class="kw">&lt;-</span> <span class="fl">5</span>


<span class="co">#lx &lt;- 0.22</span>
<span class="co">#ly &lt;- 0.25</span>
<span class="co">#hy &lt;- 0.77</span>
<span class="co">#hx &lt;- 0.78</span>
<span class="co">#</span>
<span class="co">#risk_labels &lt;-data.frame(label = c("low\nrisk","moderate\nrisk","moderate\nrisk","high\nrisk"),</span>
<span class="co">#                        x = c(lx,lx,hx,hx),</span>
<span class="co">#                        y = c(ly,hy,ly,hy),</span>
<span class="co">#                        hjust = c(0,0,0,0),</span>
<span class="co">#                        vjust = c(0,0,0,0))</span>

<span class="co">#constant looping var</span>
<span class="no">i</span> <span class="kw">&lt;-</span> <span class="fl">1</span></pre></body></html></div>
</div>
<div id="plotting-code" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-code" class="anchor"></a>Plotting code</h2>
<p>From here, the code to plot the correlation figures is run but the resulting figures are <em>NOT</em> shown, as they need a bit of spacing adjustments to be visualized in this vignette. However, <code>.pdf</code> output of the individual plots with attached legends are saved to <code>/vignettes</code>. Notably, <code>Vignette-041-market-plot</code> covers both the impact model and multiple correlation analyses that aid in interpretation of these plots.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">plots_which</span>)) {

  <span class="co">#selects states or countries to plot</span>
  <span class="no">statez</span> <span class="kw">=</span> <span class="no">plots_which</span>[<span class="no">i</span>]

  <span class="co">########################</span>
  <span class="co">#DATA SELECTION STEP</span>
  <span class="co">########################</span>

  <span class="co">#checks whether to use wine or grapes as the impact product to consider</span>
  <span class="kw">if</span>(<span class="no">impact_prod</span> <span class="kw">==</span> <span class="st">"wine"</span>){
    <span class="kw">if</span> (<span class="no">statez</span>) {
      <span class="co">#selects the data to modify for plotting: STATES and chooses the timing</span>
      <span class="kw">if</span>(<span class="no">present_transport</span>){
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">states_summary_present</span>
      } <span class="kw">else</span>{
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">states_summary_future</span>
      }

      <span class="co">#calls the exact variables to plot</span>
      <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(
          <span class="kw">x_to_plot</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span>,
          <span class="kw">y_to_plot</span> <span class="kw">=</span> <span class="no">grand_mean_max_scaled</span>,
          <span class="kw">fill_to_plot</span> <span class="kw">=</span> <span class="no">grapes</span>,
          <span class="kw">size_to_plot</span> <span class="kw">=</span> <span class="no">avg_wine</span>,
          <span class="kw">color_to_plot</span> <span class="kw">=</span> <span class="no">status</span>
        ) <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">grapes</span>), (<span class="no">size_to_plot</span>)) <span class="co">#so that the grape producers are on top</span>

      <span class="co">#order the data that gets labeled based on top_to_plot</span>
      <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">data_to_plot</span>, <span class="no">top_to_plot</span>)  <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
      <span class="co">#do welch t.test to assess if transport and establishment have the same relationship with grapes</span>
      <span class="no">state_grape_t.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">transport</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">avg_infected_mass_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>),
                                <span class="kw">establishment</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">grand_mean_max_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>))

      <span class="co">#add infected state labeling if turned on</span>
      <span class="kw">if</span>(<span class="no">label.states.est</span>){
        <span class="kw">if</span>(<span class="no">present_transport</span>){  <span class="co">#PRESENT</span>
          <span class="no">data_to_label_states.est</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Connecticut"</span>, <span class="st">"Delaware"</span>, <span class="st">"Maryland"</span>, <span class="st">"New Jersey"</span>, <span class="st">"Ohio"</span>, <span class="st">"West Virginia"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
        <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">data_to_label</span>,<span class="no">data_to_label_states.est</span>)
        } <span class="kw">else</span> <span class="kw">if</span>(<span class="no">present_transport</span> <span class="kw">==</span> <span class="fl">FALSE</span>){  <span class="co">#FUTURE</span>
          <span class="no">data_to_label_states.est</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Connecticut"</span>, <span class="st">"Delaware"</span>, <span class="st">"Maryland"</span>, <span class="st">"New Jersey"</span>, <span class="st">"Ohio"</span>, <span class="st">"West Virginia"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
        <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">data_to_label</span>,<span class="no">data_to_label_states.est</span>)
        }
      } <span class="co">#end of labeling for infected states</span>

    } <span class="kw">else</span> {
      <span class="co">#selects the data to modify for plotting: COUNTRIES and selects the timing</span>
      <span class="kw">if</span>(<span class="no">present_transport</span>){
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present</span>
      } <span class="kw">else</span>{
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future</span>
      }

      <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(
          <span class="kw">x_to_plot</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span>,
          <span class="kw">y_to_plot</span> <span class="kw">=</span> <span class="no">grand_mean_max_scaled</span>,
          <span class="kw">fill_to_plot</span> <span class="kw">=</span> <span class="no">grapes</span>,
          <span class="kw">size_to_plot</span> <span class="kw">=</span> <span class="no">avg_wine</span>,
          <span class="kw">color_to_plot</span> <span class="kw">=</span> <span class="no">status</span>
        ) <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">grapes</span>), (<span class="no">size_to_plot</span>)) <span class="co">#so that the grape producers are on top</span>
      <span class="no">data_to_label</span> <span class="kw">&lt;-</span>
        <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">data_to_plot</span>, <span class="no">top_to_plot</span>)  <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>)) <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(
          <span class="kw">ID</span> <span class="kw">=</span> <span class="fu">recode</span>(              <span class="co">#add ISO3 codes for the labeled countries (rather than all)</span>
            <span class="no">ID</span>,
            <span class="kw">Italy</span> <span class="kw">=</span> <span class="st">"ITA"</span>,
            <span class="kw">France</span> <span class="kw">=</span> <span class="st">"FRA"</span>,
            <span class="kw">Spain</span> <span class="kw">=</span> <span class="st">"ESP"</span>,
            <span class="kw">China</span> <span class="kw">=</span> <span class="st">"CHN"</span>,
            <span class="kw">Argentina</span> <span class="kw">=</span> <span class="st">"ARG"</span>,
            <span class="kw">Chile</span> <span class="kw">=</span> <span class="st">"CHL"</span>,
            <span class="kw">Australia</span> <span class="kw">=</span> <span class="st">"AUS"</span>,
            <span class="kw">`South Africa`</span> <span class="kw">=</span> <span class="st">"ZAF"</span>,
            <span class="kw">Germany</span> <span class="kw">=</span> <span class="st">"DEU"</span>,
            <span class="kw">Portugal</span> <span class="kw">=</span> <span class="st">"PRT"</span>
          )
        )

      <span class="co">#do welch t.test to assess if transport and establishment have the same relationship with grapes</span>
      <span class="no">country_grape_t.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">transport</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">avg_infected_mass_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>),
                                   <span class="kw">establishment</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">grand_mean_max_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>))
      <span class="kw">if</span>(<span class="no">label.countries.est</span>){
        <span class="no">data_to_label_countries.est</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Japan"</span>, <span class="st">"South Korea"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">ID</span> <span class="kw">=</span> <span class="fu">recode</span>(<span class="no">ID</span>,
                             <span class="kw">Japan</span> <span class="kw">=</span> <span class="st">"JPN"</span>,
                             <span class="kw">`South Korea`</span> <span class="kw">=</span> <span class="st">"KOR"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
        <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">data_to_label</span>,<span class="no">data_to_label_countries.est</span>)
      }
    }
  } <span class="kw">else</span> <span class="kw">if</span>(<span class="no">impact_prod</span> <span class="kw">==</span> <span class="st">"grapes"</span>){
    <span class="kw">if</span> (<span class="no">statez</span>) {
      <span class="co">#selects the data to modify for plotting: STATES and chooses the timing</span>
      <span class="kw">if</span>(<span class="no">present_transport</span>){
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">states_summary_present</span>
      } <span class="kw">else</span>{
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">states_summary_future</span>
      }

      <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(
          <span class="kw">x_to_plot</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span>,
          <span class="kw">y_to_plot</span> <span class="kw">=</span> <span class="no">grand_mean_max_scaled</span>,
          <span class="kw">fill_to_plot</span> <span class="kw">=</span> <span class="no">wine</span>,
          <span class="kw">size_to_plot</span> <span class="kw">=</span> <span class="no">avg_prod</span>, <span class="co">#avg_yield or avg_prod are the two options here for grapes</span>
          <span class="kw">color_to_plot</span> <span class="kw">=</span> <span class="no">status</span>
        ) <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">grapes</span>), (<span class="no">size_to_plot</span>)) <span class="co">#so that the grape producers are on top</span>
      <span class="co">#change the zeros to one's for plot size</span>
      <span class="no">data_to_plot</span>$<span class="no">size_to_plot</span>[<span class="no">data_to_plot</span>$<span class="no">size_to_plot</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">1</span>

      <span class="no">data_to_label</span> <span class="kw">&lt;-</span>
        <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">data_to_plot</span>, <span class="no">top_to_plot</span>)  <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
      <span class="no">state_grape_t.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">transport</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">avg_infected_mass_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>),
                                 <span class="kw">establishment</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">grand_mean_max_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>))

      <span class="co">#add infected state labeling if turned on</span>
      <span class="kw">if</span>(<span class="no">label.states.est</span>){
        <span class="kw">if</span>(<span class="no">present_transport</span>){  <span class="co">#PRESENT</span>
          <span class="no">data_to_label_states.est</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Connecticut"</span>, <span class="st">"Delaware"</span>, <span class="st">"Maryland"</span>, <span class="st">"New Jersey"</span>, <span class="st">"Ohio"</span>, <span class="st">"West Virginia"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
        <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">data_to_label</span>,<span class="no">data_to_label_states.est</span>)
        } <span class="kw">else</span> <span class="kw">if</span>(<span class="no">present_transport</span> <span class="kw">==</span> <span class="fl">FALSE</span>){  <span class="co">#FUTURE</span>
          <span class="no">data_to_label_states.est</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Connecticut"</span>, <span class="st">"Delaware"</span>, <span class="st">"Maryland"</span>, <span class="st">"New Jersey"</span>, <span class="st">"Ohio"</span>, <span class="st">"West Virginia"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
        <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">data_to_label</span>,<span class="no">data_to_label_states.est</span>)
        }
      } <span class="co">#end of labeling for infected states</span>


    } <span class="kw">else</span> {
      <span class="co">#selects the data to modify for plotting: COUNTRIES and selects the timing</span>
      <span class="kw">if</span>(<span class="no">present_transport</span>){
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_present</span>
      } <span class="kw">else</span>{
        <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future</span>
      }

      <span class="no">data_to_plot</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(
          <span class="kw">x_to_plot</span> <span class="kw">=</span> <span class="no">avg_infected_mass_scaled</span>,
          <span class="kw">y_to_plot</span> <span class="kw">=</span> <span class="no">grand_mean_max_scaled</span>,
          <span class="kw">fill_to_plot</span> <span class="kw">=</span> <span class="no">wine</span>,
          <span class="kw">size_to_plot</span> <span class="kw">=</span> <span class="no">avg_prod</span>, <span class="co">#avg_yield or avg_prod are the two options here for grapes</span>
          <span class="kw">color_to_plot</span> <span class="kw">=</span> <span class="no">status</span>
        ) <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">grapes</span>), (<span class="no">size_to_plot</span>)) <span class="co">#so that the grape producers are on top</span>
      <span class="co">#change the zeros to one's for plot size</span>
      <span class="no">data_to_plot</span>$<span class="no">size_to_plot</span>[<span class="no">data_to_plot</span>$<span class="no">size_to_plot</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">1</span>

      <span class="no">data_to_label</span> <span class="kw">&lt;-</span>
        <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">data_to_plot</span>, <span class="no">top_to_plot</span>)  <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))

      <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="no">data_to_label</span> <span class="kw">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(
          <span class="kw">ID</span> <span class="kw">=</span> <span class="fu">recode</span>(
            <span class="no">ID</span>,
            <span class="kw">Egypt</span> <span class="kw">=</span> <span class="st">"EGY"</span>,
            <span class="kw">Peru</span> <span class="kw">=</span> <span class="st">"PER"</span>,
            <span class="kw">India</span> <span class="kw">=</span> <span class="st">"IND"</span>,
            <span class="kw">Albania</span> <span class="kw">=</span> <span class="st">"ALB"</span>,
            <span class="kw">Iraq</span> <span class="kw">=</span> <span class="st">"IRQ"</span>,
            <span class="kw">Brazil</span> <span class="kw">=</span> <span class="st">"BRA"</span>,
            <span class="kw">Thailand</span> <span class="kw">=</span> <span class="st">"THA"</span>,
            <span class="kw">`South Africa`</span> <span class="kw">=</span> <span class="st">"ZAF"</span>,
            <span class="kw">China</span> <span class="kw">=</span> <span class="st">"CHN"</span>,
            <span class="kw">Armenia</span> <span class="kw">=</span> <span class="st">"ARM"</span>,
            <span class="kw">Italy</span> <span class="kw">=</span> <span class="st">"ITA"</span>,
            <span class="kw">Spain</span> <span class="kw">=</span> <span class="st">"ESP"</span>,
            <span class="kw">France</span> <span class="kw">=</span> <span class="st">"FRA"</span>,
            <span class="kw">Turkey</span> <span class="kw">=</span> <span class="st">"TUR"</span>,
            <span class="kw">Chile</span> <span class="kw">=</span> <span class="st">"CHL"</span>,
            <span class="kw">Argentina</span> <span class="kw">=</span> <span class="st">"ARG"</span>,
            <span class="kw">Australia</span> <span class="kw">=</span> <span class="st">"AUS"</span>,
            <span class="kw">`South Korea`</span> <span class="kw">=</span> <span class="st">"KOR"</span>,
            <span class="kw">Japan</span> <span class="kw">=</span> <span class="st">"JPN"</span>
          )
        )

      <span class="no">country_grape_t.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">transport</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">avg_infected_mass_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>),
                                  <span class="kw">establishment</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">grand_mean_max_scaled</span>~<span class="no">grapes</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>))
      <span class="kw">if</span>(<span class="no">label.countries.est</span>){
        <span class="no">data_to_label_countries.est</span> <span class="kw">&lt;-</span> <span class="no">data_to_plot</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">geopol_unit</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Japan"</span>, <span class="st">"South Korea"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">ID</span> <span class="kw">=</span> <span class="fu">recode</span>(<span class="no">ID</span>,
                             <span class="kw">Japan</span> <span class="kw">=</span> <span class="st">"JPN"</span>,
                             <span class="kw">`South Korea`</span> <span class="kw">=</span> <span class="st">"KOR"</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">arrange</a></span>(<span class="fu">desc</span>(<span class="no">size_to_plot</span>))
        <span class="no">data_to_label</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">data_to_label</span>,<span class="no">data_to_label_countries.est</span>)
      } <span class="co"># end of if label plotting JPN KOR</span>
    }
  }


<span class="co">########################</span>
<span class="co">#PLOT SETTINGS STEP</span>
<span class="co">########################</span>

<span class="co">#SET ALL OF THE NUDGES FOR LABELS</span>
<span class="co">#need to add the conditional for present transport, since nudging only works based on the data</span>
<span class="kw">if</span>(<span class="no">present_transport</span> <span class="kw">==</span> <span class="fl">FALSE</span>){
  <span class="kw">if</span>(<span class="no">impact_prod</span> <span class="kw">==</span> <span class="st">"wine"</span>){
    <span class="co">#nudging</span>
    <span class="kw">if</span>(<span class="no">statez</span>) { <span class="co">#STATES FUTURE WINE</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.1</span>,-<span class="fl">.1</span>,-<span class="fl">.1</span>,-<span class="fl">.05</span>,-<span class="fl">.1</span>,-<span class="fl">0.05</span>,-<span class="fl">.1</span>,<span class="fl">.06</span>,-<span class="fl">.01</span>,<span class="fl">.05</span>)
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.2</span>,<span class="fl">.10</span>,<span class="fl">.10</span>,<span class="fl">.10</span>,<span class="fl">.07</span>,<span class="fl">.15</span>,<span class="fl">.15</span>,-<span class="fl">.07</span>,-<span class="fl">.12</span>,-<span class="fl">.12</span>)    <span class="co">#CA, WA, NY, PA, OR, GA, OH, MI, VA, NC</span>
      <span class="kw">if</span>(<span class="no">label.states.est</span>){
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_states.est.x</span>)
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_states.est.y</span>)
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    } <span class="kw">else</span> {  <span class="co">#COUNTRIES FUTURE WINE</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.3</span>,-<span class="fl">.27</span>,-<span class="fl">.05</span>,-<span class="fl">.26</span>,<span class="fl">.14</span>,<span class="fl">.1</span>,<span class="fl">.20</span>,-<span class="fl">.21</span>,<span class="fl">.08</span>,<span class="fl">.2</span>)
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.13</span>, <span class="fl">.095</span>, <span class="fl">.155</span>, <span class="fl">.09</span>, -<span class="fl">.11</span>, <span class="fl">.13</span>, <span class="fl">.15</span>,<span class="fl">.06</span>,-<span class="fl">.1</span>,-<span class="fl">.19</span>)  <span class="co">#ITA, FRA, ESP, CHN, ARG, CHL, AUS, ZAF, DEU, PRT</span>
      <span class="kw">if</span>(<span class="no">label.countries.est</span>) {
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_countries.est_future.x</span>) <span class="co">#JPN KOR</span>
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_countries.est_future.y</span>) <span class="co">#JPN KOR</span>
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    }
  } <span class="kw">else</span> <span class="kw">if</span>(<span class="no">impact_prod</span> <span class="kw">==</span> <span class="st">"grapes"</span>){
    <span class="co">#nudging</span>
    <span class="kw">if</span>(<span class="no">statez</span>) { <span class="co">#STATES FUTURE GRAPES</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.00</span>,-<span class="fl">.05</span>,-<span class="fl">.06</span>,-<span class="fl">.02</span>, <span class="fl">.10</span>,-<span class="fl">.05</span>,-<span class="fl">.01</span>,-<span class="fl">.01</span>,-<span class="fl">.05</span>,-<span class="fl">.03</span>)   <span class="co">#yield: #CA, PA, WA, MI, NY, MO, OH, OR, GA, NC</span>
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.10</span>, <span class="fl">.10</span>, <span class="fl">.08</span>, <span class="fl">.08</span>,-<span class="fl">.05</span>, <span class="fl">.09</span>,-<span class="fl">.10</span>,-<span class="fl">.10</span>, <span class="fl">.09</span>, <span class="fl">.10</span>)   <span class="co">#production: CA, WA, NY, PA, MI, OR, TX, VA, NC, MO</span>
      <span class="kw">if</span>(<span class="no">label.states.est</span>){
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_states.est.x</span>)
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_states.est.y</span>)
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    } <span class="kw">else</span> {  <span class="co">#COUNTRIES FUTURE GRAPES</span>
      <span class="co">#ensemble version</span>
      <span class="co"># grape prod: CHN, ITA, ESP, FRA, TUR, IND, CHL, ARG, ZAF, AUS</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.00</span>,-<span class="fl">0.00</span>,-<span class="fl">0.01</span>,-<span class="fl">0.02</span>,-<span class="fl">0.00</span>, <span class="fl">0.03</span>,-<span class="fl">0.02</span>, <span class="fl">0.03</span>,-<span class="fl">0.02</span>,-<span class="fl">0.00</span>)
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.10</span>, <span class="fl">0.085</span>, <span class="fl">0.15</span>, <span class="fl">0.07</span>,-<span class="fl">0.10</span>, <span class="fl">0.05</span>, <span class="fl">0.13</span>,-<span class="fl">0.15</span>, <span class="fl">0.29</span>,-<span class="fl">0.12</span>)
      <span class="co">#old version</span>
      <span class="co"># grape production: CHN, ITA, ESP, FRA, TUR, IND, CHL, ARG, ZAF, AUS</span>
      <span class="co">#nudge.x &lt;- c(-0.01,-0.00,-0.00,-0.04, 0.02,0.03,-0.04, 0.05,-0.03, 0.04)</span>
      <span class="co">#nudge.y &lt;- c(-0.10,-0.20,-0.27, 0.06,-0.24,0.07, 0.11,-0.23, 0.16,-0.10)</span>
      <span class="kw">if</span>(<span class="no">label.countries.est</span>) {
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_countries.est_future.x</span>) <span class="co">#JPN KOR</span>
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_countries.est_future.y</span>) <span class="co">#JPN KOR</span>
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    }
  }
} <span class="kw">else</span> { <span class="co"># grapes above wine below NOTE may not work with labeling JPN and KOR</span>
  <span class="kw">if</span>(<span class="no">impact_prod</span> <span class="kw">==</span> <span class="st">"wine"</span>){
    <span class="kw">if</span>(<span class="no">statez</span>) { <span class="co">#STATES PRESENT WINE</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.09</span>,-<span class="fl">.1</span>,-<span class="fl">.04</span>,-<span class="fl">.05</span>,-<span class="fl">.10</span>,-<span class="fl">0.12</span>,-<span class="fl">.1</span>,<span class="fl">.04</span>,-<span class="fl">.01</span>,<span class="fl">.05</span>)
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.10</span>,<span class="fl">.10</span>,<span class="fl">.10</span>,<span class="fl">.10</span>,<span class="fl">.07</span>,<span class="fl">.10</span>,<span class="fl">.12</span>,-<span class="fl">.07</span>,-<span class="fl">.12</span>,-<span class="fl">.12</span>)    <span class="co">#CA, WA, NY, PA, OR, GA, OH, MI, VA, NC</span>
      <span class="kw">if</span>(<span class="no">label.states.est</span>){
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_states.est.x</span>)
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_states.est.y</span>)
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    } <span class="kw">else</span> { <span class="co">#COUNTRIES PRESENT WINE</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.03</span>,-<span class="fl">.10</span>,-<span class="fl">.02</span>,-<span class="fl">.03</span>,<span class="fl">.14</span>,-<span class="fl">.1</span>,-<span class="fl">.23</span>,-<span class="fl">.21</span>,<span class="fl">.08</span>,<span class="fl">.2</span>)
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.13</span>, <span class="fl">.09</span>, <span class="fl">.155</span>, <span class="fl">.09</span>, -<span class="fl">.11</span>, <span class="fl">.13</span>, <span class="fl">.15</span>,<span class="fl">.09</span>,-<span class="fl">.08</span>,-<span class="fl">.15</span>)  <span class="co">#ITA, FRA, ESP, CHN, ARG, CHL, AUS, ZAF, DEU, PRT</span>
      <span class="kw">if</span>(<span class="no">label.countries.est</span>) {
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_countries.est.x</span>) <span class="co">#JPN KOR</span>
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_countries.est.y</span>) <span class="co">#JPN KOR</span>
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    }
  } <span class="kw">else</span> <span class="kw">if</span>(<span class="no">impact_prod</span> <span class="kw">==</span> <span class="st">"grapes"</span>){
    <span class="kw">if</span>(<span class="no">statez</span>) { <span class="co">#STATES PRESENT GRAPES</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.00</span>,-<span class="fl">.05</span>,-<span class="fl">.06</span>,-<span class="fl">.02</span>, <span class="fl">.10</span>,-<span class="fl">.05</span>,-<span class="fl">.01</span>,-<span class="fl">.01</span>,-<span class="fl">.05</span>,-<span class="fl">.03</span>)   <span class="co">#yield: #CA, PA, WA, MI, NY, MO, OH, OR, GA, NC</span>
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.10</span>, <span class="fl">.10</span>, <span class="fl">.08</span>, <span class="fl">.08</span>,-<span class="fl">.05</span>, <span class="fl">.09</span>,-<span class="fl">.10</span>,-<span class="fl">.10</span>, <span class="fl">.09</span>, <span class="fl">.10</span>)   <span class="co">#production: CA, WA, NY, PA, MI, OR, TX, VA, NC, MO</span>

      <span class="kw">if</span>(<span class="no">label.states.est</span>){
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_states.est.x</span>)
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_states.est.y</span>)
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    } <span class="kw">else</span> { <span class="co">#COUNTRIES PRESENT GRAPES</span>
            <span class="co">#ensemble version</span>
      <span class="co"># grape prod: CHN, ITA, ESP, FRA, TUR, IND, CHL, ARG, ZAF, AUS</span>
      <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.00</span>,-<span class="fl">0.00</span>,-<span class="fl">0.01</span>,-<span class="fl">0.02</span>,-<span class="fl">0.00</span>, <span class="fl">0.03</span>,-<span class="fl">0.02</span>, <span class="fl">0.05</span>,-<span class="fl">0.02</span>, <span class="fl">0.01</span>)
      <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.10</span>, <span class="fl">0.08</span>, <span class="fl">0.15</span>, <span class="fl">0.07</span>,-<span class="fl">0.10</span>, <span class="fl">0.05</span>, <span class="fl">0.13</span>,-<span class="fl">0.12</span>, <span class="fl">0.29</span>,-<span class="fl">0.09</span>)
      <span class="co">#nudge.x &lt;- c(-0.01, 0.02, 0.10,-0.04, 0.06,-0.02,-0.07, 0.05,-0.20, 0.11)   #CHN, ITA, ESP, FRA, TUR, IND, CHL, ARG, ZAF, AUS</span>
      <span class="co">#nudge.y &lt;- c( 0.08,-0.08,-0.20, 0.07,-0.02, 0.10, 0.12,-0.09,-0.07,-0.25)</span>
      <span class="kw">if</span>(<span class="no">label.countries.est</span>) {
        <span class="no">nudge.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.x</span>, <span class="no">nudge_countries.est.x</span>) <span class="co">#JPN KOR</span>
        <span class="no">nudge.y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nudge.y</span>, <span class="no">nudge_countries.est.y</span>) <span class="co">#JPN KOR</span>
      }
      <span class="no">ytitle</span> <span class="kw">&lt;-</span> <span class="st">"Establishment Potential"</span>
    }
  }
}


  <span class="co">#CREATE THE STATES PLOT</span>
  (<span class="no">states_plot</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_plot</span>) +
      <span class="co">#geom_text(data = risk_labels, mapping = aes(x = x, y = y,label = label), color = risk_color, size = risk_size) +</span>
      <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="no">q_intercepts</span>$<span class="no">establishment</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>) +
      <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="no">q_intercepts</span>$<span class="no">transport</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>) +
      <span class="co">#  geom_abline(intercept = 0, slope = 1, linetype = "solid") + # add one to one</span>
      <span class="fu">geom_rect</span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu">aes</span>(<span class="kw">xmin</span><span class="kw">=</span><span class="fl">1.01</span>, <span class="kw">xmax</span><span class="kw">=</span><span class="fl">1.2</span>, <span class="kw">ymin</span><span class="kw">=</span><span class="fl">.49</span>, <span class="kw">ymax</span><span class="kw">=</span><span class="fl">.5</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>) +
      <span class="fu">geom_rect</span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu">aes</span>(<span class="kw">ymin</span><span class="kw">=</span><span class="fl">1.01</span>, <span class="kw">ymax</span><span class="kw">=</span><span class="fl">1.2</span>, <span class="kw">xmin</span><span class="kw">=</span><span class="fl">.49</span>, <span class="kw">xmax</span><span class="kw">=</span><span class="fl">.51</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>) +
      <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">data_to_label</span>,
                      <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x_to_plot</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y_to_plot</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">ID</span>),
                      <span class="kw">min.segment.length</span> <span class="kw">=</span> <span class="fl">0</span>,
                      <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"x"</span>,
                      <span class="kw">nudge_y</span> <span class="kw">=</span> <span class="no">nudge.y</span>,
                      <span class="kw">nudge_x</span> <span class="kw">=</span> <span class="no">nudge.x</span>
      ) +
      <span class="fu">geom_point</span>(
        <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x_to_plot</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y_to_plot</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">fill_to_plot</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="no">size_to_plot</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">color_to_plot</span>),
        <span class="kw">shape</span> <span class="kw">=</span> <span class="fl">21</span>, <span class="kw">stroke</span> <span class="kw">=</span> <span class="fl">1.3</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.75</span>
      ) +
      <span class="co"># geom_text(data = risk_labels, mapping = aes(x = x, y = y,label = label), color = risk_color, size = risk_size) +</span>
      <span class="fu">scale_fill_manual</span>(
        <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span> <span class="kw">=</span> <span class="st">"#ffffff"</span>, <span class="st">"yes"</span> <span class="kw">=</span> <span class="st">"#C77CFF"</span>),
        <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Wine Production"</span>,<span class="co"># "Wine Impact Potential",</span>
        <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"high"</span>, <span class="st">"low"</span>)
      ) +
      <span class="fu">scale_color_manual</span>(
        <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
          <span class="st">"red"</span>,
          <span class="st">"black"</span>,
          <span class="st">"blue"</span>),
        <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
          <span class="st">"established"</span>,
          <span class="st">"not established"</span>,
          <span class="st">"native"</span>),
        <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Regional Status"</span>,
        <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"invaded"</span>,<span class="st">"uninvaded"</span>, <span class="st">"native"</span>)
      ) +
      <span class="fu">guides</span>(
        <span class="kw">fill</span> <span class="kw">=</span> <span class="fu">guide_legend</span>(
          <span class="kw">order</span> <span class="kw">=</span> <span class="fl">1</span>,
          <span class="kw">override.aes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">shape</span> <span class="kw">=</span> <span class="fl">22</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">1</span>)
        ),
        <span class="kw">color</span> <span class="kw">=</span> <span class="fu">guide_legend</span>(
          <span class="kw">order</span> <span class="kw">=</span> <span class="fl">3</span>,
          <span class="kw">override.aes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">1</span>)
        ),
        <span class="kw">size</span> <span class="kw">=</span> <span class="fu">guide_legend</span>(    <span class="co"># Adjust size to edit legend grape production</span>
          <span class="kw">order</span> <span class="kw">=</span> <span class="fl">2</span>,            <span class="co"># circles.</span>
          <span class="kw">override.aes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">6</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">1</span>)
        )
      ) +
      <span class="fu">scale_size_continuous</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"Grape Production"</span>,
                            <span class="kw">trans</span> <span class="kw">=</span> <span class="st">"log10"</span>,
                            <span class="kw">range</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.5</span>, <span class="fl">6</span>),
                            <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.5</span>,<span class="fl">2</span>,<span class="fl">6</span>),
                            <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"low"</span>, <span class="st">"moderate"</span>, <span class="st">"high"</span>)
      ) +
      <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Transport Potential"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">ytitle</span>) +
      <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">1.2</span>) + <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fl">0</span>, <span class="fl">1.2</span>) +
      <span class="fu">theme</span>(
        <span class="kw">panel.grid.major</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#f0f0f0"</span>),
        <span class="kw">panel.grid.minor</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="co">#panel.grid.major = element_blank(),</span>
        <span class="co">#panel.border = element_rect(colour = "black", fill=NA, size=1),</span>
        <span class="kw">axis.line</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.7</span>, <span class="fl">0.25</span>),
        <span class="co">#legend.position = "bottom",</span>
        <span class="kw">panel.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">plot.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">legend.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),<span class="co">#element_rect(colour = 'black', fill = 'white', linetype='solid'),</span>
        <span class="kw">axis.text</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fu">rel</span>(<span class="fl">1</span>)),
        <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">.4</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">.35</span>),
        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"plain"</span>),
        <span class="kw">legend.key.size</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>),
        <span class="kw">legend.key</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">plot.margin</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">hh</span>, -<span class="fl">5</span>, <span class="no">hh</span>, <span class="no">hh</span>), <span class="kw">units</span> <span class="kw">=</span> <span class="st">"line"</span>),
        <span class="kw">axis.title</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fu">rel</span>(<span class="fl">1.3</span>))
      ) +
      <span class="fu">scale_x_continuous</span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">.5</span>,<span class="fl">1</span>),<span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"low"</span>, <span class="st">"moderate"</span>, <span class="st">"high"</span>)) +
      <span class="fu">scale_y_continuous</span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">.5</span>,<span class="fl">1</span>),<span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"low"</span>, <span class="st">"moderate"</span>, <span class="st">"high"</span>)) +
      <span class="fu">coord_flip</span>()
  )

  <span class="co">#get the legend</span>
  <span class="no">get_legend</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">myggplot</span>) {
    <span class="no">tmp</span> <span class="kw">&lt;-</span> <span class="fu">ggplot_gtable</span>(<span class="fu">ggplot_build</span>(<span class="no">myggplot</span>))
    <span class="no">leg</span> <span class="kw">&lt;-</span>
      <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">tmp</span>$<span class="no">grobs</span>, <span class="kw">function</span>(<span class="no">x</span>)
        <span class="no">x</span>$<span class="no">name</span>) <span class="kw">==</span> <span class="st">"guide-box"</span>)
    <span class="no">legend</span> <span class="kw">&lt;-</span> <span class="no">tmp</span>$<span class="no">grobs</span><span class="kw">[[</span><span class="no">leg</span>]]
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">legend</span>)
  }
  <span class="co">#plot all of it</span>
  <span class="kw">if</span>(<span class="no">statez</span>) {
    <span class="no">legend_state</span> <span class="kw">&lt;-</span> <span class="no">legend</span> <span class="kw">&lt;-</span> <span class="fu">get_legend</span>(<span class="no">states_plot</span>)
  } <span class="kw">else</span> {
    <span class="no">legend_country</span> <span class="kw">&lt;-</span> <span class="no">legend</span> <span class="kw">&lt;-</span> <span class="fu">get_legend</span>(<span class="no">states_plot</span>)
  }


  (<span class="no">states_plot</span> <span class="kw">&lt;-</span> <span class="no">states_plot</span> + <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>))


  <span class="co">#boxplot: ESTABLISHMENT</span>
  (
    <span class="no">states_box_estab</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">data_to_plot</span>) +
      <span class="fu">geom_boxplot</span>(
        <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">fill_to_plot</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y_to_plot</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">fill_to_plot</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">fill_to_plot</span>),
        <span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
        <span class="kw">outlier.shape</span> <span class="kw">=</span> <span class="fl">NA</span>,
        <span class="kw">notch</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
        <span class="kw">notchwidth</span> <span class="kw">=</span> <span class="fl">.25</span>
      ) +
    <span class="co">#labs(x = "Major grape producer", y = "Observed Max Suitability") +</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">1</span>) +
      <span class="fu">scale_fill_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"yes"</span> <span class="kw">=</span> <span class="st">"#C77CFF"</span>, <span class="st">"no"</span> <span class="kw">=</span> <span class="st">"#ffffff"</span>), <span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>) +
      <span class="co">#ggtitle(label = "States Grape Production vs. Average Model Maxes") +</span>
      <span class="fu">theme</span>(
        <span class="kw">axis.line</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.ticks</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>,
        <span class="kw">panel.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.border</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.grid.major</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.grid.minor</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">plot.margin</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">hh</span>, <span class="no">hh</span>, <span class="no">hh</span>, <span class="no">hh</span>), <span class="kw">units</span> <span class="kw">=</span> <span class="st">"line"</span>),
        <span class="kw">plot.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>()
      ) +
      <span class="fu">coord_flip</span>()
  )

  <span class="co">#boxplot: INTRODUCTION</span>
  (
    <span class="no">states_box_intro</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">data_to_plot</span>) +
      <span class="fu">geom_boxplot</span>(
        <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">fill_to_plot</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">x_to_plot</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">fill_to_plot</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">fill_to_plot</span>),
        <span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
        <span class="kw">outlier.shape</span> <span class="kw">=</span> <span class="fl">NA</span>,
        <span class="kw">notch</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
        <span class="kw">notchwidth</span> <span class="kw">=</span> <span class="fl">.25</span>
      ) +
      <span class="co">#labs(x = "  ", y = "Observed Max Suitability") +</span>
      <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"  "</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="kw">NULL</span>) +
      <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">1</span>) +
      <span class="fu">scale_fill_manual</span>(
        <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"yes"</span> <span class="kw">=</span> <span class="st">"#C77CFF"</span>, <span class="st">"no"</span> <span class="kw">=</span> <span class="st">"#ffffff"</span>),
        <span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>
      ) +
      <span class="co">#coord_flip() +</span>
      <span class="co">#ggtitle(label = "States Grape Production vs. Average Model Maxes") +</span>
      <span class="fu">theme</span>(
        <span class="kw">axis.line</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.ticks</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="co">#axis.title.y=element_blank(),</span>
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>,
        <span class="kw">panel.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.border</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.grid.major</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">panel.grid.minor</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">plot.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">plot.margin</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">hh</span>, <span class="no">hh</span>, <span class="no">hh</span>, <span class="no">hh</span>), <span class="kw">units</span> <span class="kw">=</span> <span class="st">"line"</span>)
      )
  )


  <span class="co"># Insert xbp_grob inside the scatter plot</span>
  <span class="co">#x = x_to_plot,</span>
  <span class="co">#y = y_to_plot</span>
  (
    <span class="no">states_plot_final</span> <span class="kw">&lt;-</span> <span class="no">states_plot</span> +
      <span class="co"># annotation_custom(grob = legend, xmin = .465, ymax = .6) +</span>
      <span class="co">#coord_cartesian(clip = "off") +</span>
      <span class="fu">annotation_custom</span>(
        <span class="kw">grob</span> <span class="kw">=</span> <span class="fu">ggplotGrob</span>(<span class="no">states_box_estab</span>),
        <span class="kw">xmin</span> <span class="kw">=</span> <span class="fl">1.01</span>,
        <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">1.11</span>,
        <span class="kw">ymin</span> <span class="kw">=</span> -<span class="fl">Inf</span>,
        <span class="kw">ymax</span> <span class="kw">=</span> <span class="fl">1.05</span>
      ) +
      <span class="co"># Insert ybp_grob inside the scatter plot</span>
      <span class="fu">annotation_custom</span>(
        <span class="kw">grob</span> <span class="kw">=</span> <span class="fu">ggplotGrob</span>(<span class="no">states_box_intro</span>),
        <span class="kw">xmin</span> <span class="kw">=</span> -<span class="fl">.1</span>,
        <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">1.05</span>,
        <span class="kw">ymin</span> <span class="kw">=</span> <span class="fl">1</span>,
        <span class="kw">ymax</span> <span class="kw">=</span> <span class="fl">1.1</span>
      ) +

      <span class="fu">annotation_custom</span>(
        <span class="kw">grob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html">rectGrob</a></span>(<span class="kw">gp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"white"</span>)),
        <span class="kw">xmin</span> <span class="kw">=</span> -<span class="fl">1</span>,
        <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">1.21</span>,
        <span class="kw">ymin</span> <span class="kw">=</span> <span class="fl">1.1</span>,
        <span class="kw">ymax</span> <span class="kw">=</span> <span class="fl">1.21</span>
      ) +
      <span class="fu">annotation_custom</span>(
        <span class="kw">grob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html">rectGrob</a></span>(<span class="kw">gp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"white"</span>)),
        <span class="kw">ymin</span> <span class="kw">=</span> -<span class="fl">1</span>,
        <span class="kw">ymax</span> <span class="kw">=</span> <span class="fl">1.21</span>,
        <span class="kw">xmin</span> <span class="kw">=</span> <span class="fl">1.11</span>,
        <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">1.21</span>
      ) +
      <span class="fu">scale_x_continuous</span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">.5</span>,<span class="fl">1</span>),<span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"low"</span>, <span class="st">"moderate"</span>, <span class="st">"high"</span>), <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1.15</span>)) +
      <span class="fu">scale_y_continuous</span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">.5</span>,<span class="fl">1</span>),<span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"low"</span>, <span class="st">"moderate"</span>, <span class="st">"high"</span>), <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1.15</span>))
  )

  <span class="no">g</span> <span class="kw">&lt;-</span> <span class="fu">ggplotGrob</span>(<span class="no">states_plot_final</span>)
  <span class="no">g</span>$<span class="no">layout</span>$<span class="no">clip</span>[<span class="no">g</span>$<span class="no">layout</span>$<span class="no">name</span> <span class="kw">==</span> <span class="st">"panel"</span>] <span class="kw">&lt;-</span> <span class="st">"off"</span>
  <span class="co">#g$layout</span>
  <span class="no">g</span>$<span class="no">layout</span>$<span class="no">z</span>[<span class="no">g</span>$<span class="no">layout</span>$<span class="no">name</span> <span class="kw">==</span> <span class="st">"panel"</span>] <span class="kw">&lt;-</span> <span class="fl">17</span> <span class="co"># Note that z for panel is 1.  Change it to something bigger.</span>

  <span class="co">#grid.newpage()</span>
  <span class="co">#grid.draw(g)</span>


<span class="co">#Correlation Analysis</span>
  <span class="co"># present or future</span>
 <span class="kw">if</span>(<span class="no">present_transport</span>){
    <span class="kw">if</span> (<span class="no">statez</span>) { <span class="co">#states present</span>
      <span class="no">states_grob</span> <span class="kw">&lt;-</span> <span class="no">g</span>
    } <span class="kw">else</span> {  <span class="co">#countries present</span>
      <span class="no">countries_grob</span> <span class="kw">&lt;-</span> <span class="no">g</span>
  }
   }  <span class="kw">else</span> {    <span class="co">#future cases</span>
    <span class="kw">if</span> (<span class="no">statez</span>) { <span class="co">#states future</span>
      <span class="no">states_grob</span> <span class="kw">&lt;-</span> <span class="no">g</span>
    } <span class="kw">else</span>{ <span class="co">#countries future</span>
      <span class="no">countries_grob</span> <span class="kw">&lt;-</span> <span class="no">g</span>
      }
            }

<span class="co">#SAVES RESULTS AS PDF</span>
<span class="co">#plot the states+legend and save</span>
<span class="co">#outer loop to turn off the saving</span>
<span class="kw">if</span>(<span class="fl">FALSE</span>){
  <span class="kw">if</span> (<span class="no">statez</span>) {
  <span class="kw">if</span>(<span class="no">present_transport</span>){
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"states_combined_present_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">7</span>)

} <span class="kw">else</span>{
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"states_combined_future_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">7</span>)

}
      <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">states_grob</span>, <span class="no">legend_state</span>, <span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">widths</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">2</span>), <span class="kw">heights</span> <span class="kw">=</span> <span class="fl">1</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>())
} <span class="kw">else</span>{
  <span class="co">#plot the countries+legend</span>
<span class="kw">if</span>(<span class="no">present_transport</span>){
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"countries_combined_present_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">7</span>)

} <span class="kw">else</span>{
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"countries_combined_future_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">7</span>)

}
      <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">countries_grob</span>, <span class="no">legend_country</span>, <span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">widths</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">2</span>), <span class="kw">heights</span> <span class="kw">=</span> <span class="fl">1</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>())

}

} <span class="co">#end the turn off and on save PDF loop</span>

} <span class="co"># end of the 2 loop for loop for plotting states and countries</span></pre></body></html></div>
<p>Despite the focus of <code>Vignette-041-market-plot</code>, we also tag on a quick piece of code that will calculate the correlations for both versions of the <code>impact_prod</code> for the <code>present</code> case. We remove <code>countries</code> with established <em>Lycorma</em> populations.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co">#grapes</span>
<span class="co">#STATES</span>

<span class="co">#build model</span>
<span class="no">states_grapes_impact_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">formula</span> <span class="kw">=</span> <span class="no">log10_avg_prod</span> ~ <span class="no">avg_infected_mass_scaled</span> + <span class="no">grand_mean_max_scaled</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">states_summary_present</span>)
<span class="co">#do cor</span>
<span class="no">states_grapes_impact_cor</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">states_grapes_impact_model</span>$<span class="no">model</span>$<span class="no">log10_avg_prod</span>, <span class="no">states_grapes_impact_model</span>$<span class="no">fitted.values</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="no">method_cor</span>)

<span class="co">#COUNTRIES</span>
<span class="co">#build model</span>
<span class="no">countries_grapes_impact_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">formula</span> <span class="kw">=</span> <span class="no">log10_avg_prod</span> ~ <span class="no">avg_infected_mass_scaled</span> + <span class="no">grand_mean_max_scaled</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">countries_summary_present</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"United States"</span>,
                      <span class="st">"China"</span>,
                      <span class="st">"India"</span>,
                      <span class="st">"Taiwan"</span>,
                      <span class="st">"Japan"</span>,
                      <span class="st">"South Korea"</span>,
                      <span class="st">"Vietnam"</span>)))
<span class="co">#do cor</span>
<span class="no">countries_grapes_impact_cor</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">countries_grapes_impact_model</span>$<span class="no">model</span>$<span class="no">log10_avg_prod</span>, <span class="no">countries_grapes_impact_model</span>$<span class="no">fitted.values</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="no">method_cor</span>)

<span class="co">#wine</span>
<span class="co">#STATES</span>
<span class="co">#model</span>
<span class="no">states_wine_impact_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">formula</span> <span class="kw">=</span> <span class="no">log10_avg_wine</span> ~ <span class="no">avg_infected_mass_scaled</span> + <span class="no">grand_mean_max_scaled</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">states_summary_present</span>)
<span class="co">#cor</span>
<span class="no">states_wine_impact_cor</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">states_wine_impact_model</span>$<span class="no">model</span>$<span class="no">log10_avg_wine</span>, <span class="no">states_wine_impact_model</span>$<span class="no">fitted.values</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="no">method_cor</span>)

<span class="co">#COUNTRIES</span>
<span class="co">#model</span>
<span class="no">countries_wine_impact_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">formula</span> <span class="kw">=</span> <span class="no">log10_avg_wine</span> ~ <span class="no">avg_infected_mass_scaled</span> + <span class="no">grand_mean_max_scaled</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">countries_summary_present</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"United States"</span>,
                      <span class="st">"China"</span>,
                      <span class="st">"India"</span>,
                      <span class="st">"Taiwan"</span>,
                      <span class="st">"Japan"</span>,
                      <span class="st">"South Korea"</span>,
                      <span class="st">"Vietnam"</span>)))
<span class="co">#cor</span>
<span class="no">countries_wine_impact_cor</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">countries_wine_impact_model</span>$<span class="no">model</span>$<span class="no">log10_avg_wine</span>, <span class="no">countries_wine_impact_model</span>$<span class="no">fitted.values</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="no">method_cor</span>)</pre></body></html></div>
</div>
<div id="plotting-results-and-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-results-and-visualization" class="anchor"></a>Plotting results and visualization</h2>
<div id="correlation-results" class="section level3">
<h3 class="hasAnchor">
<a href="#correlation-results" class="anchor"></a>Correlation results</h3>
<p>We can report the following alignment of potentials:</p>
<ol style="list-style-type: decimal">
<li><strong>GRAPES</strong></li>
</ol>
<ul>
<li>U.S. State Alignment Correlation = 0.413, p = 2.582 x 10<sup>-03</sup>
</li>
<li>Country Alignment Correlation = 0.672, p = 1.115 x 10<sup>-30</sup>
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>WINE</strong></li>
</ol>
<ul>
<li>U.S. State Alignment Correlation = 0.518, p = 1.004 x 10<sup>-04</sup>
</li>
<li>Country Alignment Correlation = 0.662, p = 1.776 x 10<sup>-29</sup>
</li>
</ul>
<blockquote>
<p>Note: <strong>grapes</strong> is the plotted impact product.</p>
</blockquote>
</div>
<div id="plot-visualization" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-visualization" class="anchor"></a>Plot visualization</h3>
<div id="static" class="section level4">
<h4 class="hasAnchor">
<a href="#static" class="anchor"></a>Static</h4>
<p>Now that the plotting code has been run, the <code>states</code> and <code>countries</code> correlation plots can be visualized together:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co">#set up a layout grid</span>
  <span class="no">lay1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">NA</span>, <span class="fl">3</span>, <span class="fl">3</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>, <span class="fl">3</span>, <span class="fl">3</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>,<span class="fl">NA</span>, <span class="fl">3</span>, <span class="fl">3</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>)
  )</pre></body></html></div>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co">#nice version for knitting</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">states_grob</span>, <span class="no">countries_grob</span>, <span class="no">legend_country</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">layout_matrix</span> <span class="kw">=</span> <span class="no">lay1</span>, <span class="kw">heights</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>), <span class="kw">widths</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.1</span>,<span class="fl">0.6</span>,<span class="fl">0.6</span>))</pre></body></html></div>
<p><img src="vignette-021-quadrant-plots_files/figure-html/visualization%20step-1.png" width="960"></p>
</div>
<div id="interactive" class="section level4">
<h4 class="hasAnchor">
<a href="#interactive" class="anchor"></a>Interactive</h4>
<p><code>Plotly</code>-based visualization of each alignment plot makes it easier to see individual points.</p>
<div id="htmlwidget-7b4cbef8f11728ca9ecb" style="width:768px;height:768px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7b4cbef8f11728ca9ecb">{"x":{"data":[{"x":[-0.055,1.155],"y":[0.5,0.5],"text":"","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0.5],"y":[-0.055,1.155],"text":"","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.87,0.88,0.83,0.87,0.87],"y":[0.99,0.86,0.87,1,0.96],"text":["NY<br />establishment potential: 0.87<br />transport potential: 0.99<br />avg_wine: 5.04<br />grapes: yes<br />status: established","NC<br />establishment potential: 0.88<br />transport potential: 0.86<br />avg_wine: 3.79<br />grapes: yes<br />status: established","OH<br />establishment potential: 0.83<br />transport potential: 0.87<br />avg_wine: 4.24<br />grapes: yes<br />status: established","PA<br />establishment potential: 0.87<br />transport potential: 1.00<br />avg_wine: 4.64<br />grapes: yes<br />status: established","VA<br />establishment potential: 0.87<br />transport potential: 0.96<br />avg_wine: 3.82<br />grapes: yes<br />status: established"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":0.75,"size":[20.7387546115837,18.7370805688238,19.4911180715193,20.1283994986949,18.78869810708],"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(255,0,0,1)"}},"hoveron":"points","name":"(yes,established)","legendgroup":"(yes,established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.76,0.78,0.85,0.62,0.74,0.78,0.54,0.78],"y":[0.44,0.72,0.74,0.87,0.59,0.37,0.79,0.45],"text":["AR<br />establishment potential: 0.76<br />transport potential: 0.44<br />avg_wine: 2.95<br />grapes: yes<br />status: not established","CA<br />establishment potential: 0.78<br />transport potential: 0.72<br />avg_wine: 6.42<br />grapes: yes<br />status: not established","GA<br />establishment potential: 0.85<br />transport potential: 0.74<br />avg_wine: 4.40<br />grapes: yes<br />status: not established","MI<br />establishment potential: 0.62<br />transport potential: 0.87<br />avg_wine: 3.92<br />grapes: yes<br />status: not established","MO<br />establishment potential: 0.74<br />transport potential: 0.59<br />avg_wine: 3.62<br />grapes: yes<br />status: not established","OR<br />establishment potential: 0.78<br />transport potential: 0.37<br />avg_wine: 4.61<br />grapes: yes<br />status: not established","TX<br />establishment potential: 0.54<br />transport potential: 0.79<br />avg_wine: 3.76<br />grapes: yes<br />status: not established","WA<br />establishment potential: 0.78<br />transport potential: 0.45<br />avg_wine: 5.14<br />grapes: yes<br />status: not established"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":0.75,"size":[17.1983413779377,22.6771653543307,19.7494923334379,18.9593087424434,18.4406411764833,20.0815808927977,18.685258332038,20.8875189612052],"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(yes,not established)","legendgroup":"(yes,not established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.84,0.87,0.88,0.87,0.75],"y":[0.77,0.73,0.9,0.97,0.8],"text":["CT<br />establishment potential: 0.84<br />transport potential: 0.77<br />avg_wine: 2.73<br />grapes: no<br />status: established","DE<br />establishment potential: 0.87<br />transport potential: 0.73<br />avg_wine: 0.00<br />grapes: no<br />status: established","MD<br />establishment potential: 0.88<br />transport potential: 0.90<br />avg_wine: 3.18<br />grapes: no<br />status: established","NJ<br />establishment potential: 0.87<br />transport potential: 0.97<br />avg_wine: 3.76<br />grapes: no<br />status: established","WV<br />establishment potential: 0.75<br />transport potential: 0.80<br />avg_wine: 2.14<br />grapes: no<br />status: established"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,255,255,1)","opacity":0.75,"size":[16.7601160061706,5.66929133858268,17.6393444160127,18.685258332038,15.488791979918],"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(255,0,0,1)"}},"hoveron":"points","name":"(no,established)","legendgroup":"(no,established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.69,0.03,0.51,0.51,0.25,0.25,0.53,0.68,0.85,0.6,0.7,0.86,0.53,0.79,0.85,0.34,0.7,0.47,0.6,0.45,0.81,0.4,0.08,0.74,0.85,0.84,0.5,0.85,0.51,0.41,0.87,0.58,0.21],"y":[0.62,0,0.39,0.41,0.69,0,0.26,0.76,0.83,0.52,0.48,0.78,0.64,0.51,0.78,0.57,0.42,0.2,0.38,0.29,0.6,0.18,0.42,0.45,0.58,0.79,0.22,0.71,0.35,0.54,0.49,0.62,0.09],"text":["AL<br />establishment potential: 0.69<br />transport potential: 0.62<br />avg_wine: 2.16<br />grapes: no<br />status: not established","AK<br />establishment potential: 0.03<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","AZ<br />establishment potential: 0.51<br />transport potential: 0.39<br />avg_wine: 2.89<br />grapes: no<br />status: not established","CO<br />establishment potential: 0.51<br />transport potential: 0.41<br />avg_wine: 3.22<br />grapes: no<br />status: not established","FL<br />establishment potential: 0.25<br />transport potential: 0.69<br />avg_wine: 3.84<br />grapes: no<br />status: not established","HI<br />establishment potential: 0.25<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","ID<br />establishment potential: 0.53<br />transport potential: 0.26<br />avg_wine: 3.35<br />grapes: no<br />status: not established","IL<br />establishment potential: 0.68<br />transport potential: 0.76<br />avg_wine: 3.17<br />grapes: no<br />status: not established","IN<br />establishment potential: 0.85<br />transport potential: 0.83<br />avg_wine: 3.66<br />grapes: no<br />status: not established","IA<br />establishment potential: 0.60<br />transport potential: 0.52<br />avg_wine: 3.03<br />grapes: no<br />status: not established","KS<br />establishment potential: 0.70<br />transport potential: 0.48<br />avg_wine: 2.48<br />grapes: no<br />status: not established","KY<br />establishment potential: 0.86<br />transport potential: 0.78<br />avg_wine: 3.90<br />grapes: no<br />status: not established","LA<br />establishment potential: 0.53<br />transport potential: 0.64<br />avg_wine: 2.08<br />grapes: no<br />status: not established","ME<br />establishment potential: 0.79<br />transport potential: 0.51<br />avg_wine: 2.33<br />grapes: no<br />status: not established","MA<br />establishment potential: 0.85<br />transport potential: 0.78<br />avg_wine: 3.33<br />grapes: no<br />status: not established","MN<br />establishment potential: 0.34<br />transport potential: 0.57<br />avg_wine: 3.01<br />grapes: no<br />status: not established","MS<br />establishment potential: 0.70<br />transport potential: 0.42<br />avg_wine: 0.00<br />grapes: no<br />status: not established","MT<br />establishment potential: 0.47<br />transport potential: 0.20<br />avg_wine: 2.22<br />grapes: no<br />status: not established","NE<br />establishment potential: 0.60<br />transport potential: 0.38<br />avg_wine: 2.60<br />grapes: no<br />status: not established","NV<br />establishment potential: 0.45<br />transport potential: 0.29<br />avg_wine: 0.00<br />grapes: no<br />status: not established","NH<br />establishment potential: 0.81<br />transport potential: 0.60<br />avg_wine: 2.69<br />grapes: no<br />status: not established","NM<br />establishment potential: 0.40<br />transport potential: 0.18<br />avg_wine: 3.45<br />grapes: no<br />status: not established","ND<br />establishment potential: 0.08<br />transport potential: 0.42<br />avg_wine: 0.00<br />grapes: no<br />status: not established","OK<br />establishment potential: 0.74<br />transport potential: 0.45<br />avg_wine: 2.36<br />grapes: no<br />status: not established","RI<br />establishment potential: 0.85<br />transport potential: 0.58<br />avg_wine: 0.00<br />grapes: no<br />status: not established","SC<br />establishment potential: 0.84<br />transport potential: 0.79<br />avg_wine: 2.17<br />grapes: no<br />status: not established","SD<br />establishment potential: 0.50<br />transport potential: 0.22<br />avg_wine: 2.47<br />grapes: no<br />status: not established","TN<br />establishment potential: 0.85<br />transport potential: 0.71<br />avg_wine: 3.68<br />grapes: no<br />status: not established","UT<br />establishment potential: 0.51<br />transport potential: 0.35<br />avg_wine: 0.00<br />grapes: no<br />status: not established","VT<br />establishment potential: 0.41<br />transport potential: 0.54<br />avg_wine: 4.10<br />grapes: no<br />status: not established","DC<br />establishment potential: 0.87<br />transport potential: 0.49<br />avg_wine: 0.00<br />grapes: no<br />status: not established","WI<br />establishment potential: 0.58<br />transport potential: 0.62<br />avg_wine: 3.56<br />grapes: no<br />status: not established","WY<br />establishment potential: 0.21<br />transport potential: 0.09<br />avg_wine: 0.00<br />grapes: no<br />status: not established"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,255,255,1)","opacity":0.75,"size":[15.5345707858518,5.66929133858268,17.0804945015878,17.7143925059262,18.8229972682749,5.66929133858268,17.9551331640521,17.6205087582738,18.5110072728764,17.3536217738302,16.2401035218121,18.9253622823953,15.350156778336,15.9154358455021,17.918404107797,17.3149957823906,5.66929133858268,15.6706500340443,16.4928279407411,5.66929133858268,16.678564718426,18.1371555501499,5.66929133858268,15.9811871801805,5.66929133858268,15.5573807109778,16.2187698730577,18.5460461263628,5.66929133858268,19.2610121326045,5.66929133858268,18.3343590249185,5.66929133858268],"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(no,not established)","legendgroup":"(no,not established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":37.2602739726027,"l":72.3287671232877},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.055,1.155],"tickmode":"array","ticktext":["low","moderate","high"],"tickvals":[0,0.5,1],"categoryorder":"array","categoryarray":["low","moderate","high"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(240,240,240,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"establishment potential","font":{"color":"rgba(0,0,0,1)","family":"","size":11}},"hoverformat":".2f","showspikes":true},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.055,1.155],"tickmode":"array","ticktext":["low","moderate","high"],"tickvals":[0,0.5,1],"categoryorder":"array","categoryarray":["low","moderate","high"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(240,240,240,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"transport potential","font":{"color":"rgba(0,0,0,1)","family":"","size":11}},"hoverformat":".2f","showspikes":true},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1},"hovermode":"closest","barmode":"relative","title":{"text":"US States Invasion Potential Alignment","font":{"size":12},"x":0.1,"y":0.99}},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"12c5b7d19e3f7":{"yintercept":{},"type":"scatter"},"12c5b2ec5ad4b":{"xintercept":{}},"12c5b33f42eea":{"text":{},"x":{},"y":{},"size":{},"fill":{},"colour":{}}},"cur_data":"12c5b7d19e3f7","visdat":{"12c5b7d19e3f7":["function (y) ","x"],"12c5b2ec5ad4b":["function (y) ","x"],"12c5b33f42eea":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-696a6363729c5b0a61f9" style="width:768px;height:768px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-696a6363729c5b0a61f9">{"x":{"data":[{"x":[-0.055,1.155],"y":[0.5,0.5],"text":"","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0.5],"y":[-0.055,1.155],"text":"","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.79],"y":[0.93],"text":"Japan<br />establishment potential: 0.79<br />transport potential: 0.93<br />avg_wine: 4.91<br />grapes: yes<br />status: established","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":0.75,"size":20.2946571182201,"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(255,0,0,1)"}},"hoveron":"points","name":"(yes,established)","legendgroup":"(yes,established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.81,0.55,0.43,0.4],"y":[1,0.96,0.83,0.83],"text":["China<br />establishment potential: 0.81<br />transport potential: 1.00<br />avg_wine: 6.23<br />grapes: yes<br />status: native","India<br />establishment potential: 0.55<br />transport potential: 0.96<br />avg_wine: 0.00<br />grapes: yes<br />status: native","Taiwan<br />establishment potential: 0.43<br />transport potential: 0.83<br />avg_wine: 0.00<br />grapes: yes<br />status: native","Vietnam<br />establishment potential: 0.40<br />transport potential: 0.83<br />avg_wine: 0.00<br />grapes: yes<br />status: native"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":0.75,"size":[22.1437067910191,5.66929133858268,5.66929133858268,5.66929133858268],"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(0,0,255,1)"}},"hoveron":"points","name":"(yes,native)","legendgroup":"(yes,native)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0.74,0.72,0.73,0.55,0.73,0.72,0.69,0,0.39,0.79,0.84,0.74,0.65,0.77,0.82,0.43,0.72,0.16,0.44,0.46,0.09,0.48,0.86,0.67,0.85,0.72,0.51,0.31,0.6,0.5,0.44,0.85,0.41,0.59,0,0.57,0.73,0.49,0.68,0.41,0.38,0.55,0.72,0.75,0.18,0.68,0.85,0.52,0.11,0.34,0.8,0,0.61,0.19,0.67,0.61,0.71,0.63,0.75,0.86,0.52,0.21,0.6,0.75,0.49,0.65,0.15,0.75,0.81,0.57,0.33,0.51],"y":[0.61,0.57,0.71,0.8,0.53,0.79,0.69,0.57,0.63,0.47,0.88,0.63,0.94,0.6,0.95,0.81,0.81,0.83,0.69,0.53,0.75,0.83,0.6,0.89,0.69,0.89,0.71,0.78,0.82,0.62,0.66,0.8,0.92,0.71,0.63,0.73,0.53,0.7,0.64,0.59,0.5,0.67,0.86,0.39,0.87,0.62,0.96,0.7,0.79,0.61,0.81,0.77,0.66,0.76,0.81,0.52,0.76,0.71,0.75,0.85,0.7,0.48,0.83,0.76,0.93,0.54,0.88,0.8,0.93,0.65,0.44,0.74,0.48],"text":["Afghanistan<br />establishment potential: 0.50<br />transport potential: 0.61<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Albania<br />establishment potential: 0.74<br />transport potential: 0.57<br />avg_wine: 4.49<br />grapes: yes<br />status: not established","Algeria<br />establishment potential: 0.72<br />transport potential: 0.71<br />avg_wine: 4.70<br />grapes: yes<br />status: not established","Argentina<br />establishment potential: 0.73<br />transport potential: 0.80<br />avg_wine: 6.14<br />grapes: yes<br />status: not established","Armenia<br />establishment potential: 0.55<br />transport potential: 0.53<br />avg_wine: 3.79<br />grapes: yes<br />status: not established","Australia<br />establishment potential: 0.73<br />transport potential: 0.79<br />avg_wine: 6.08<br />grapes: yes<br />status: not established","Austria<br />establishment potential: 0.72<br />transport potential: 0.69<br />avg_wine: 5.34<br />grapes: yes<br />status: not established","Azerbaijan<br />establishment potential: 0.69<br />transport potential: 0.57<br />avg_wine: 3.92<br />grapes: yes<br />status: not established","Bahrain<br />establishment potential: 0.00<br />transport potential: 0.63<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Belarus<br />establishment potential: 0.39<br />transport potential: 0.47<br />avg_wine: 4.45<br />grapes: yes<br />status: not established","Belgium<br />establishment potential: 0.79<br />transport potential: 0.88<br />avg_wine: 3.46<br />grapes: yes<br />status: not established","Bosnia and Herzegovina<br />establishment potential: 0.84<br />transport potential: 0.63<br />avg_wine: 3.69<br />grapes: yes<br />status: not established","Brazil<br />establishment potential: 0.74<br />transport potential: 0.94<br />avg_wine: 5.45<br />grapes: yes<br />status: not established","Bulgaria<br />establishment potential: 0.65<br />transport potential: 0.60<br />avg_wine: 5.12<br />grapes: yes<br />status: not established","Canada<br />establishment potential: 0.77<br />transport potential: 0.95<br />avg_wine: 4.79<br />grapes: yes<br />status: not established","Chile<br />establishment potential: 0.82<br />transport potential: 0.81<br />avg_wine: 6.10<br />grapes: yes<br />status: not established","Colombia<br />establishment potential: 0.43<br />transport potential: 0.81<br />avg_wine: 4.09<br />grapes: yes<br />status: not established","Croatia<br />establishment potential: 0.72<br />transport potential: 0.83<br />avg_wine: 4.67<br />grapes: yes<br />status: not established","Cuba<br />establishment potential: 0.16<br />transport potential: 0.69<br />avg_wine: 4.08<br />grapes: yes<br />status: not established","Cyprus<br />establishment potential: 0.44<br />transport potential: 0.53<br />avg_wine: 4.03<br />grapes: yes<br />status: not established","Ecuador<br />establishment potential: 0.46<br />transport potential: 0.75<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Egypt<br />establishment potential: 0.09<br />transport potential: 0.83<br />avg_wine: 3.67<br />grapes: yes<br />status: not established","Ethiopia<br />establishment potential: 0.48<br />transport potential: 0.60<br />avg_wine: 3.11<br />grapes: yes<br />status: not established","France<br />establishment potential: 0.86<br />transport potential: 0.89<br />avg_wine: 6.63<br />grapes: yes<br />status: not established","Georgia<br />establishment potential: 0.67<br />transport potential: 0.69<br />avg_wine: 4.99<br />grapes: yes<br />status: not established","Germany<br />establishment potential: 0.85<br />transport potential: 0.89<br />avg_wine: 5.95<br />grapes: yes<br />status: not established","Greece<br />establishment potential: 0.72<br />transport potential: 0.71<br />avg_wine: 5.50<br />grapes: yes<br />status: not established","Guatemala<br />establishment potential: 0.51<br />transport potential: 0.78<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Honduras<br />establishment potential: 0.31<br />transport potential: 0.82<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Hungary<br />establishment potential: 0.60<br />transport potential: 0.62<br />avg_wine: 5.41<br />grapes: yes<br />status: not established","Iraq<br />establishment potential: 0.50<br />transport potential: 0.66<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Israel<br />establishment potential: 0.44<br />transport potential: 0.80<br />avg_wine: 3.70<br />grapes: yes<br />status: not established","Italy<br />establishment potential: 0.85<br />transport potential: 0.92<br />avg_wine: 6.64<br />grapes: yes<br />status: not established","Jordan<br />establishment potential: 0.41<br />transport potential: 0.71<br />avg_wine: 2.68<br />grapes: yes<br />status: not established","Kazakhstan<br />establishment potential: 0.59<br />transport potential: 0.63<br />avg_wine: 4.29<br />grapes: yes<br />status: not established","Kuwait<br />establishment potential: 0.00<br />transport potential: 0.73<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Kyrgyzstan<br />establishment potential: 0.57<br />transport potential: 0.53<br />avg_wine: 3.20<br />grapes: yes<br />status: not established","Lebanon<br />establishment potential: 0.73<br />transport potential: 0.70<br />avg_wine: 4.17<br />grapes: yes<br />status: not established","Libya<br />establishment potential: 0.49<br />transport potential: 0.64<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Luxembourg<br />establishment potential: 0.68<br />transport potential: 0.59<br />avg_wine: 4.02<br />grapes: yes<br />status: not established","Madagascar<br />establishment potential: 0.41<br />transport potential: 0.50<br />avg_wine: 3.92<br />grapes: yes<br />status: not established","Malta<br />establishment potential: 0.38<br />transport potential: 0.67<br />avg_wine: 3.39<br />grapes: yes<br />status: not established","Mexico<br />establishment potential: 0.55<br />transport potential: 0.86<br />avg_wine: 4.60<br />grapes: yes<br />status: not established","Montenegro<br />establishment potential: 0.72<br />transport potential: 0.39<br />avg_wine: 4.22<br />grapes: yes<br />status: not established","Morocco<br />establishment potential: 0.75<br />transport potential: 0.87<br />avg_wine: 4.56<br />grapes: yes<br />status: not established","Namibia<br />establishment potential: 0.18<br />transport potential: 0.62<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Netherlands<br />establishment potential: 0.68<br />transport potential: 0.96<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","New Zealand<br />establishment potential: 0.85<br />transport potential: 0.70<br />avg_wine: 5.40<br />grapes: yes<br />status: not established","Pakistan<br />establishment potential: 0.52<br />transport potential: 0.79<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Paraguay<br />establishment potential: 0.11<br />transport potential: 0.61<br />avg_wine: 3.16<br />grapes: yes<br />status: not established","Peru<br />establishment potential: 0.34<br />transport potential: 0.81<br />avg_wine: 4.84<br />grapes: yes<br />status: not established","Portugal<br />establishment potential: 0.80<br />transport potential: 0.77<br />avg_wine: 5.79<br />grapes: yes<br />status: not established","Qatar<br />establishment potential: 0.00<br />transport potential: 0.66<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Romania<br />establishment potential: 0.61<br />transport potential: 0.76<br />avg_wine: 5.61<br />grapes: yes<br />status: not established","Saudi Arabia<br />establishment potential: 0.19<br />transport potential: 0.81<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Serbia<br />establishment potential: 0.67<br />transport potential: 0.52<br />avg_wine: 5.33<br />grapes: yes<br />status: not established","Slovakia<br />establishment potential: 0.61<br />transport potential: 0.76<br />avg_wine: 4.53<br />grapes: yes<br />status: not established","Slovenia<br />establishment potential: 0.71<br />transport potential: 0.71<br />avg_wine: 4.30<br />grapes: yes<br />status: not established","South Africa<br />establishment potential: 0.63<br />transport potential: 0.75<br />avg_wine: 6.04<br />grapes: yes<br />status: not established","Spain<br />establishment potential: 0.75<br />transport potential: 0.85<br />avg_wine: 6.61<br />grapes: yes<br />status: not established","Switzerland<br />establishment potential: 0.86<br />transport potential: 0.70<br />avg_wine: 4.97<br />grapes: yes<br />status: not established","Tajikistan<br />establishment potential: 0.52<br />transport potential: 0.48<br />avg_wine: 2.18<br />grapes: yes<br />status: not established","Thailand<br />establishment potential: 0.21<br />transport potential: 0.83<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Tunisia<br />establishment potential: 0.60<br />transport potential: 0.76<br />avg_wine: 4.44<br />grapes: yes<br />status: not established","Turkey<br />establishment potential: 0.75<br />transport potential: 0.93<br />avg_wine: 4.55<br />grapes: yes<br />status: not established","Turkmenistan<br />establishment potential: 0.49<br />transport potential: 0.54<br />avg_wine: 4.59<br />grapes: yes<br />status: not established","Ukraine<br />establishment potential: 0.65<br />transport potential: 0.88<br />avg_wine: 5.16<br />grapes: yes<br />status: not established","United Arab Emirates<br />establishment potential: 0.15<br />transport potential: 0.80<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","United Kingdom<br />establishment potential: 0.75<br />transport potential: 0.93<br />avg_wine: 2.84<br />grapes: yes<br />status: not established","Uruguay<br />establishment potential: 0.81<br />transport potential: 0.65<br />avg_wine: 4.90<br />grapes: yes<br />status: not established","Uzbekistan<br />establishment potential: 0.57<br />transport potential: 0.44<br />avg_wine: 4.56<br />grapes: yes<br />status: not established","Yemen<br />establishment potential: 0.33<br />transport potential: 0.74<br />avg_wine: 0.00<br />grapes: yes<br />status: not established","Zimbabwe<br />establishment potential: 0.51<br />transport potential: 0.48<br />avg_wine: 3.24<br />grapes: yes<br />status: not established"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":0.75,"size":[5.66929133858268,19.6551508369234,19.9784770263763,22.0242773152332,18.5187726033091,21.9441707798486,20.9216362964518,18.7372882759379,5.66929133858268,19.5927136523745,17.9466244649067,18.3481211869847,21.0779289618914,20.6041449812744,20.1148302087945,21.9709166967273,19.0176431512983,19.932736305119,19.0013148860884,18.9193717401249,5.66929133858268,18.3137145296644,17.3091092120439,22.6643533946852,20.4133232887125,21.7692393399138,21.148449410983,5.66929133858268,5.66929133858268,21.0212793670861,5.66929133858268,18.3652895494172,22.6771653543307,16.4745057095103,19.3401135893355,5.66929133858268,17.4763298466248,19.147557179346,5.66929133858268,18.902922223663,18.7372882759379,17.8217972110872,19.8254332070415,19.2281213507261,19.763750378248,5.66929133858268,5.66929133858268,21.007084275721,5.66929133858268,17.4023037970802,20.1900287328996,21.5512942893773,5.66929133858268,21.3024746779721,5.66929133858268,20.9073483823483,19.7173105187538,19.3560376742338,21.8905466490884,22.638700456204,20.3837464646444,15.4145694445465,5.66929133858268,19.5770605588212,19.7482874454087,19.8100377246527,20.6623707523573,5.66929133858268,16.7923738932624,20.2797560794254,19.763750378248,5.66929133858268,17.5498946612056],"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(yes,not established)","legendgroup":"(yes,not established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.83],"y":[0.92],"text":"South Korea<br />establishment potential: 0.83<br />transport potential: 0.92<br />avg_wine: 0.00<br />grapes: no<br />status: established","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,255,255,1)","opacity":0.75,"size":5.66929133858268,"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(255,0,0,1)"}},"hoveron":"points","name":"(no,established)","legendgroup":"(no,established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.04,0.32,0.33,0,0,0,0.01,0.02,0.01,0.01,0.01,0.01,0.48,0.34,0,0.27,0,0.01,0.01,0.4,0.06,0.23,0.34,0,0.02,0.01,0.26,0,0.3,0,0.58,0.41,0.6,0.03,0.05,0.36,0.27,0.24,0.19,0.09,0.01,0.09,0.01,0.04,0.01,0.01,0.03,0.51,0,0,0.16,0,0.55,0.09,0.01,0.03,0.33,0.12,0.06,0.41,0.78,0.69,0.18,0.02,0.31,0.61,0.5,0,0.67,0.21,0.51,0.36,0.03,0.54,0.39,0.02,0.62,0.48,0.24,0,0.01,0,0.07,0.03,0.19,0,0.58,0.01,0,0.46,0.32,0,0.38,0.16,0.27,0.01,0.12,0,0.77,0.45,0.65,0.26,0,0.44,0.23,0.31,0.58,0.18,0.02,0.65,0.82,0.48,0,0.07,0,0,0,0,0.03,0.58,0.28,0.02,0,0.03,0.01,0,0.03,0.2,0.05,0.23,0.27,0.03,0.01,0,0.52,0.59,0.65,0.55,0.19,0.03,0,0.01,0,0,0.45,0.01,0.6,0.52,0,0.2],"y":[0,0.27,0.62,0.43,0.5,0.65,0.75,0.78,0.58,0.5,0.68,0.69,0.16,0.61,0,0.36,0.52,0.43,0.46,0.4,0.64,0.68,0,0.54,0.39,0.49,0.28,0.26,0.77,0.69,0.63,0,0.71,0.72,0.64,0.81,0.74,0.48,0.32,0.57,0.39,0.76,0.35,0.55,0.56,0.51,0.71,0.77,0.23,0.46,0.46,0,0,0.61,0.48,0.62,0.65,0.82,0.57,0.87,0.61,0.74,0,0,0.74,0,0.73,0.15,0.5,0.38,0.69,0.31,0.62,0.32,0.66,0,0,0.42,0.8,0.42,0.51,0.29,0.49,0.62,0.45,0.29,0.5,0.49,0.27,0.61,0,0.07,0.43,0.49,0.66,0.47,0.75,0.14,0.32,0,0.73,0.65,0.22,0,0.75,0.46,0.79,0,0,0.34,0.78,0.42,0,0,0,0,0,0,0.53,0.29,0.24,0.67,0.37,0.57,0.81,0.53,0.27,0.66,0,0.43,0.69,0.74,0.54,0,0,0.8,0.29,0.67,0.17,0.68,0.48,0.71,0.47,0.2,0.5,0.23,0.35,0.79,0,0.5],"text":["Åland<br />establishment potential: 0.04<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Andorra<br />establishment potential: 0.32<br />transport potential: 0.27<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Angola<br />establishment potential: 0.33<br />transport potential: 0.62<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Anguilla<br />establishment potential: 0.00<br />transport potential: 0.43<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Antigua and Barbuda<br />establishment potential: 0.00<br />transport potential: 0.50<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Aruba<br />establishment potential: 0.00<br />transport potential: 0.65<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Bahamas<br />establishment potential: 0.01<br />transport potential: 0.75<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Bangladesh<br />establishment potential: 0.02<br />transport potential: 0.78<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Barbados<br />establishment potential: 0.01<br />transport potential: 0.58<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Belize<br />establishment potential: 0.01<br />transport potential: 0.50<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Benin<br />establishment potential: 0.01<br />transport potential: 0.68<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Bermuda<br />establishment potential: 0.01<br />transport potential: 0.69<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Bhutan<br />establishment potential: 0.48<br />transport potential: 0.16<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Bolivia<br />establishment potential: 0.34<br />transport potential: 0.61<br />avg_wine: 3.93<br />grapes: no<br />status: not established","Bonaire, Sint Eustatius and Saba<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Botswana<br />establishment potential: 0.27<br />transport potential: 0.36<br />avg_wine: 0.00<br />grapes: no<br />status: not established","British Virgin Islands<br />establishment potential: 0.00<br />transport potential: 0.52<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Brunei<br />establishment potential: 0.01<br />transport potential: 0.43<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Burkina Faso<br />establishment potential: 0.01<br />transport potential: 0.46<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Burundi<br />establishment potential: 0.40<br />transport potential: 0.40<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Cambodia<br />establishment potential: 0.06<br />transport potential: 0.64<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Cameroon<br />establishment potential: 0.23<br />transport potential: 0.68<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Cape Verde<br />establishment potential: 0.34<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Cayman Islands<br />establishment potential: 0.00<br />transport potential: 0.54<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Central African Republic<br />establishment potential: 0.02<br />transport potential: 0.39<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Chad<br />establishment potential: 0.01<br />transport potential: 0.49<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Comoros<br />establishment potential: 0.26<br />transport potential: 0.28<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Cook Islands<br />establishment potential: 0.00<br />transport potential: 0.26<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Costa Rica<br />establishment potential: 0.30<br />transport potential: 0.77<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Curacao<br />establishment potential: 0.00<br />transport potential: 0.69<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Czech Republic<br />establishment potential: 0.58<br />transport potential: 0.63<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Democratic Republic of the Congo<br />establishment potential: 0.41<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Denmark<br />establishment potential: 0.60<br />transport potential: 0.71<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Djibouti<br />establishment potential: 0.03<br />transport potential: 0.72<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Dominica<br />establishment potential: 0.05<br />transport potential: 0.64<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Dominican Republic<br />establishment potential: 0.36<br />transport potential: 0.81<br />avg_wine: 0.00<br />grapes: no<br />status: not established","El Salvador<br />establishment potential: 0.27<br />transport potential: 0.74<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Equatorial Guinea<br />establishment potential: 0.24<br />transport potential: 0.48<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Eritrea<br />establishment potential: 0.19<br />transport potential: 0.32<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Estonia<br />establishment potential: 0.09<br />transport potential: 0.57<br />avg_wine: 4.02<br />grapes: no<br />status: not established","Fiji<br />establishment potential: 0.01<br />transport potential: 0.39<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Finland<br />establishment potential: 0.09<br />transport potential: 0.76<br />avg_wine: 0.00<br />grapes: no<br />status: not established","French Guiana<br />establishment potential: 0.01<br />transport potential: 0.35<br />avg_wine: 0.00<br />grapes: no<br />status: not established","French Polynesia<br />establishment potential: 0.04<br />transport potential: 0.55<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Gabon<br />establishment potential: 0.01<br />transport potential: 0.56<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Gambia<br />establishment potential: 0.01<br />transport potential: 0.51<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Ghana<br />establishment potential: 0.03<br />transport potential: 0.71<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Gibraltar<br />establishment potential: 0.51<br />transport potential: 0.77<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Greenland<br />establishment potential: 0.00<br />transport potential: 0.23<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Grenada<br />establishment potential: 0.00<br />transport potential: 0.46<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Guadeloupe<br />establishment potential: 0.16<br />transport potential: 0.46<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Guam<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Guernsey<br />establishment potential: 0.55<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Guinea<br />establishment potential: 0.09<br />transport potential: 0.61<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Guinea-Bissau<br />establishment potential: 0.01<br />transport potential: 0.48<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Guyana<br />establishment potential: 0.03<br />transport potential: 0.62<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Haiti<br />establishment potential: 0.33<br />transport potential: 0.65<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Hong Kong<br />establishment potential: 0.12<br />transport potential: 0.82<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Iceland<br />establishment potential: 0.06<br />transport potential: 0.57<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Indonesia<br />establishment potential: 0.41<br />transport potential: 0.87<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Iran<br />establishment potential: 0.78<br />transport potential: 0.61<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Ireland<br />establishment potential: 0.69<br />transport potential: 0.74<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Isle of Man<br />establishment potential: 0.18<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Ivory Coast<br />establishment potential: 0.02<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Jamaica<br />establishment potential: 0.31<br />transport potential: 0.74<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Jersey<br />establishment potential: 0.61<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Kenya<br />establishment potential: 0.50<br />transport potential: 0.73<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Kiribati<br />establishment potential: 0.00<br />transport potential: 0.15<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Kosovo<br />establishment potential: 0.67<br />transport potential: 0.50<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Laos<br />establishment potential: 0.21<br />transport potential: 0.38<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Latvia<br />establishment potential: 0.51<br />transport potential: 0.69<br />avg_wine: 3.36<br />grapes: no<br />status: not established","Lesotho<br />establishment potential: 0.36<br />transport potential: 0.31<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Liberia<br />establishment potential: 0.03<br />transport potential: 0.62<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Liechtenstein<br />establishment potential: 0.54<br />transport potential: 0.32<br />avg_wine: 1.90<br />grapes: no<br />status: not established","Lithuania<br />establishment potential: 0.39<br />transport potential: 0.66<br />avg_wine: 3.78<br />grapes: no<br />status: not established","Macao<br />establishment potential: 0.02<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Macedonia<br />establishment potential: 0.62<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Malawi<br />establishment potential: 0.48<br />transport potential: 0.42<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Malaysia<br />establishment potential: 0.24<br />transport potential: 0.80<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Maldives<br />establishment potential: 0.00<br />transport potential: 0.42<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Mali<br />establishment potential: 0.01<br />transport potential: 0.51<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Marshall Islands<br />establishment potential: 0.00<br />transport potential: 0.29<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Martinique<br />establishment potential: 0.07<br />transport potential: 0.49<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Mauritania<br />establishment potential: 0.03<br />transport potential: 0.62<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Mauritius<br />establishment potential: 0.19<br />transport potential: 0.45<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Micronesia<br />establishment potential: 0.00<br />transport potential: 0.29<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Moldova<br />establishment potential: 0.58<br />transport potential: 0.50<br />avg_wine: 5.18<br />grapes: no<br />status: not established","Mongolia<br />establishment potential: 0.01<br />transport potential: 0.49<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Montserrat<br />establishment potential: 0.00<br />transport potential: 0.27<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Mozambique<br />establishment potential: 0.46<br />transport potential: 0.61<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Myanmar<br />establishment potential: 0.32<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Nauru<br />establishment potential: 0.00<br />transport potential: 0.07<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Nepal<br />establishment potential: 0.38<br />transport potential: 0.43<br />avg_wine: 0.00<br />grapes: no<br />status: not established","New Caledonia<br />establishment potential: 0.16<br />transport potential: 0.49<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Nicaragua<br />establishment potential: 0.27<br />transport potential: 0.66<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Niger<br />establishment potential: 0.01<br />transport potential: 0.47<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Nigeria<br />establishment potential: 0.12<br />transport potential: 0.75<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Niue<br />establishment potential: 0.00<br />transport potential: 0.14<br />avg_wine: 0.00<br />grapes: no<br />status: not established","North Korea<br />establishment potential: 0.77<br />transport potential: 0.32<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Northern Cyprus<br />establishment potential: 0.45<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Norway<br />establishment potential: 0.65<br />transport potential: 0.73<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Oman<br />establishment potential: 0.26<br />transport potential: 0.65<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Palau<br />establishment potential: 0.00<br />transport potential: 0.22<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Palestina<br />establishment potential: 0.44<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Panama<br />establishment potential: 0.23<br />transport potential: 0.75<br />avg_wine: 2.09<br />grapes: no<br />status: not established","Papua New Guinea<br />establishment potential: 0.31<br />transport potential: 0.46<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Poland<br />establishment potential: 0.58<br />transport potential: 0.79<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Puerto Rico<br />establishment potential: 0.18<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Republic of Congo<br />establishment potential: 0.02<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Reunion<br />establishment potential: 0.65<br />transport potential: 0.34<br />avg_wine: 1.49<br />grapes: no<br />status: not established","Russia<br />establishment potential: 0.82<br />transport potential: 0.78<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Rwanda<br />establishment potential: 0.48<br />transport potential: 0.42<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Saint Barthelemy<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Saint Helena<br />establishment potential: 0.07<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Saint Kitts and Nevis<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Saint Lucia<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Saint Martin<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Saint Vincent and the Grenadines<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Samoa<br />establishment potential: 0.03<br />transport potential: 0.53<br />avg_wine: 0.00<br />grapes: no<br />status: not established","San Marino<br />establishment potential: 0.58<br />transport potential: 0.29<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Sao Tome and Principe<br />establishment potential: 0.28<br />transport potential: 0.24<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Senegal<br />establishment potential: 0.02<br />transport potential: 0.67<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Seychelles<br />establishment potential: 0.00<br />transport potential: 0.37<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Sierra Leone<br />establishment potential: 0.03<br />transport potential: 0.57<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Singapore<br />establishment potential: 0.01<br />transport potential: 0.81<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Sint Maarten<br />establishment potential: 0.00<br />transport potential: 0.53<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Solomon Islands<br />establishment potential: 0.03<br />transport potential: 0.27<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Somalia<br />establishment potential: 0.20<br />transport potential: 0.66<br />avg_wine: 0.00<br />grapes: no<br />status: not established","South Georgia and the South Sandwich Islands<br />establishment potential: 0.05<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","South Sudan<br />establishment potential: 0.23<br />transport potential: 0.43<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Sri Lanka<br />establishment potential: 0.27<br />transport potential: 0.69<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Sudan<br />establishment potential: 0.03<br />transport potential: 0.74<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Suriname<br />establishment potential: 0.01<br />transport potential: 0.54<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Svalbard and Jan Mayen<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Swaziland<br />establishment potential: 0.52<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Sweden<br />establishment potential: 0.59<br />transport potential: 0.80<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Syria<br />establishment potential: 0.65<br />transport potential: 0.29<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Tanzania<br />establishment potential: 0.55<br />transport potential: 0.67<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Timor-Leste<br />establishment potential: 0.19<br />transport potential: 0.17<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Togo<br />establishment potential: 0.03<br />transport potential: 0.68<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Tonga<br />establishment potential: 0.00<br />transport potential: 0.48<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Trinidad and Tobago<br />establishment potential: 0.01<br />transport potential: 0.71<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Turks and Caicos Islands<br />establishment potential: 0.00<br />transport potential: 0.47<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Tuvalu<br />establishment potential: 0.00<br />transport potential: 0.20<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Uganda<br />establishment potential: 0.45<br />transport potential: 0.50<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Vanuatu<br />establishment potential: 0.01<br />transport potential: 0.23<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Vatican City<br />establishment potential: 0.60<br />transport potential: 0.35<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Venezuela<br />establishment potential: 0.52<br />transport potential: 0.79<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Virgin Islands, U.S.<br />establishment potential: 0.00<br />transport potential: 0.00<br />avg_wine: 0.00<br />grapes: no<br />status: not established","Zambia<br />establishment potential: 0.20<br />transport potential: 0.50<br />avg_wine: 0.00<br />grapes: no<br />status: not established"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,255,255,1)","opacity":0.75,"size":[5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,18.7539460225821,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,18.902922223663,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,17.7679055669523,5.66929133858268,5.66929133858268,14.7672255276538,18.501809584343,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,20.69139900686,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,15.2112852161502,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,13.7260271833642,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268,5.66929133858268],"symbol":"circle","line":{"width":4.91338582677165,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(no,not established)","legendgroup":"(no,not established)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":37.2602739726027,"l":72.3287671232877},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.055,1.155],"tickmode":"array","ticktext":["low","moderate","high"],"tickvals":[0,0.5,1],"categoryorder":"array","categoryarray":["low","moderate","high"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(240,240,240,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"establishment potential","font":{"color":"rgba(0,0,0,1)","family":"","size":11}},"hoverformat":".2f","showspikes":true},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.055,1.155],"tickmode":"array","ticktext":["low","moderate","high"],"tickvals":[0,0.5,1],"categoryorder":"array","categoryarray":["low","moderate","high"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(240,240,240,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"transport potential","font":{"color":"rgba(0,0,0,1)","family":"","size":11}},"hoverformat":".2f","showspikes":true},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1},"hovermode":"closest","barmode":"relative","title":{"text":"Countries Invasion Potential Alignment","font":{"size":12},"x":0.1,"y":0.99}},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"12c5b43941d52":{"yintercept":{},"type":"scatter"},"12c5b31111527":{"xintercept":{}},"12c5b5883cc9b":{"text":{},"x":{},"y":{},"size":{},"fill":{},"colour":{}}},"cur_data":"12c5b43941d52","visdat":{"12c5b43941d52":["function (y) ","x"],"12c5b31111527":["function (y) ","x"],"12c5b5883cc9b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
<div id="save-plot-output" class="section level1">
<h1 class="hasAnchor">
<a href="#save-plot-output" class="anchor"></a>Save plot output</h1>
<p>We can also save the static plots to <code>/vignettes</code> as a <code>.pdf</code>. Note that the saving chunks can be run by setting the top <code>if</code> from <code>FALSE</code> to <code>TRUE</code>!</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="kw">if</span>(<span class="fl">FALSE</span>){
  <span class="co">#optional save as pdf code</span>
<span class="kw">if</span>(<span class="no">present_transport</span>){
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"combined_present_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">12</span>)

} <span class="kw">else</span>{
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"combined_future_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">12</span>)

}
  <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">states_grob</span>, <span class="no">countries_grob</span>, <span class="no">legend_country</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">layout_matrix</span> <span class="kw">=</span> <span class="no">lay1</span>, <span class="kw">heights</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">widths</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.1</span>,<span class="fl">0.57</span>,<span class="fl">0.57</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>())
}</pre></body></html></div>
<p>We also save a version of the combined plots with the legend as a separate file to <code>/vignettes</code>.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="kw">if</span>(<span class="fl">FALSE</span>){
  <span class="co">#save the plots w/o legend</span>
<span class="co">#set up a layout grid</span>
  <span class="no">lay2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>,<span class="fl">NA</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>,<span class="fl">NA</span>)
  )

<span class="kw">if</span>(<span class="no">present_transport</span>){
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"combined_present_max_"</span>,<span class="no">impact_prod</span>,<span class="st">"_nolegend.pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">12</span>)
} <span class="kw">else</span>{
    <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"combined_future_max_"</span>,<span class="no">impact_prod</span>,<span class="st">"_nolegend.pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">12</span>)
}
<span class="co">#finish out the plotting</span>
  <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">states_grob</span>, <span class="no">countries_grob</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">layout_matrix</span> <span class="kw">=</span> <span class="no">lay2</span>, <span class="kw">heights</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">widths</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.99</span>,<span class="fl">0.99</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>())


<span class="co">#save the legend</span>
<span class="kw">if</span>(<span class="no">present_transport</span>){
  <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"legend_combined_present_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">10</span>)
} <span class="kw">else</span>{
  <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),<span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"legend_combined_future_max_"</span>,<span class="no">impact_prod</span>,<span class="st">".pdf"</span>)),<span class="kw">width</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">10</span>)
}
<span class="co">#finish out the plotting</span>
<span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html">grid.draw</a></span>(<span class="no">legend_country</span>)
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>())

}</pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicholas A. Huron, Jocelyn E. Behm, Matthew R. Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
