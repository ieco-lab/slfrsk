<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wine Market Risk of Shock Evaluation • slfrsk</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Wine Market Risk of Shock Evaluation">
<meta property="og:description" content="slfrsk">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slfrsk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vignette-001-overview.html">Overview</a>
</li>
<li>
  <a href="../articles/vignette-002-terms.html">Terms</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li>
      <a href="../articles/vignette-010-tidy-data.html">Data Tidying</a>
    </li>
    <li>
      <a href="../articles/vignette-011-suitability-models.html">Suitability Modeling &amp; Evaluation</a>
    </li>
    <li>
      <a href="../articles/vignette-030-risk-maps.html">Risk Map Plotting</a>
    </li>
    <li>
      <a href="../articles/vignette-021-quadrant-plots.html">Invasion Potential Alignment</a>
    </li>
    <li>
      <a href="../articles/vignette-041-market-plot.html">Wine Market Risk of Shock Evaluation</a>
    </li>
    <li>
      <a href="../articles/vignette-040-ee-data.html">Earth Engine Risk App</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ieco-lab/slfrsk">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette-041-market-plot_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="vignette-041-market-plot_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="vignette-041-market-plot_files/plotly-binding-4.9.2.1/plotly.js"></script><script src="vignette-041-market-plot_files/typedarray-0.1/typedarray.min.js"></script><script src="vignette-041-market-plot_files/jquery-1.11.3/jquery.min.js"></script><link href="vignette-041-market-plot_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="vignette-041-market-plot_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="vignette-041-market-plot_files/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="vignette-041-market-plot_files/plotly-main-1.52.2/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Wine Market Risk of Shock Evaluation</h1>
            
      
      
      <div class="hidden name"><code>vignette-041-market-plot.Rmd</code></div>

    </div>

    
    
<p>Build and Save Paninvasion Risk to Wine Market Plots</p>
<hr>
<p>This vignette aims to reproduce the published figure(s) of the relationship between the predicted production of <strong>grapes</strong> from a risk model built from the alignment of the three risk potentials (<strong>impact</strong> potential regressed on <strong>transport</strong> and <strong>establishment</strong>) to the <strong>wine market share</strong> by country.</p>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>We will first load the required packages to reproduce the published market risk figure.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">slfrsk</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggrepel</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DHARMa</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">plotly</span>)</pre></body></html></div>
</div>
<div id="load-and-summarize-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-and-summarize-data" class="anchor"></a>Load and summarize data</h1>
<div id="market-size-data" class="section level2">
<h2 class="hasAnchor">
<a href="#market-size-data" class="anchor"></a>Market size data</h2>
<p>Next, we read in the <code>countries_market</code> dataset, which contains exports of wine by <code>country</code>. The data are in thousands of USD (1000’s USD), and so we will need to convert to USD as we summarize the data. We summarize the <code>market</code> data by obtaining the <strong>mean</strong> of <span class="math inline">\(log_{10}(value+1)\)</span> transformed export values from 2012–2017.</p>
<p>We quickly visualize the distribution of these summarized <code>market_size</code> data via a histogram:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"countries_market"</span>)
<span class="co">#dim(countries_market)</span>

<span class="co"># http://www.fao.org/faostat/en/#data/TM</span>
<span class="no">countries_wine_market</span> <span class="kw">&lt;-</span> <span class="no">countries_market</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">Year</span> <span class="kw">%in%</span> (<span class="fl">2012</span>:<span class="fl">2017</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">Element</span> <span class="kw">==</span> <span class="st">"Export Value"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">group_by</a></span>(<span class="no">`Area Code`</span>, <span class="no">Area</span>, <span class="no">Year</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">`Area Code`</span>,    <span class="no">Area</span>, <span class="no">Year</span>, <span class="no">Value</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">summarise</a></span>(<span class="kw">market_size</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">Value</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">ungroup</a></span>(<span class="no">Year</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">market_size</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>((<span class="no">market_size</span>*<span class="fl">1000</span>)+<span class="fl">1</span>)) <span class="kw">%&gt;%</span> <span class="co"># units are in 1000s of USD</span>
  <span class="co">#mutate(market_size = (market_size*1000)) %&gt;%</span>

  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">summarise</a></span>(<span class="kw">market_size</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">market_size</span>))  <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">ungroup</a></span>()

<span class="co"># remove all that are zero</span>

<span class="no">countries_wine_market</span>$<span class="no">market_size</span>[<span class="no">countries_wine_market</span>$<span class="no">market_size</span><span class="kw">==</span><span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="co">#countries_wine_market$market_size &lt;- round(countries_wine_market$market_size)</span>

<span class="co">#dim(countries_wine_market)</span>
<span class="co">#countries_wine_market</span>

<span class="fu">qplot</span>((<span class="no">countries_wine_market</span>$<span class="no">market_size</span>))</pre></body></html></div>
<p><img src="vignette-041-market-plot_files/figure-html/FAO%20wine%20market-1.png" width="672"></p>
<p>From here, we add an <code>ID</code> column that matches the other use of this label in other <code>slfrsk</code> vignettes. Then, we isolate <code>ID</code> and <code>market_size</code> for risk analyses.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co">#add the ID column for joining and plotting later</span>
<span class="no">countries_wine_market</span> <span class="kw">&lt;-</span> <span class="no">countries_wine_market</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">mutate</a></span>(<span class="kw">ID</span> <span class="kw">=</span> <span class="no">Area</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">ID</span>, <span class="no">market_size</span>)</pre></body></html></div>
</div>
<div id="risk-summary-data" class="section level2">
<h2 class="hasAnchor">
<a href="#risk-summary-data" class="anchor"></a>Risk summary data</h2>
<p>To merge the new <code>market_size</code> dat with our existing <code>countries</code> data, we use <code>left_join()</code> to merge the <code>market</code> and <code>summary</code> data by <code>ID</code>. We then remove the countries from the dataset that already have <strong>SLF</strong>. Note: we use a modified version of <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> and <code><a href="https://rdrr.io/r/base/funprog.html">Negate()</a></code> to create <code>%notin%</code> for removing countries.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">#data("countries_summary_future")</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"countries_summary_future_ensemble"</span>)
<span class="no">countries_summary_future_ensemble</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future_ensemble</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Antarctica"</span>, <span class="st">"Monaco"</span>, <span class="st">"Norfolk Island"</span>, <span class="st">"Spratly Islands"</span>))

<span class="co">#remove non-focal countries</span>
<span class="no">rems</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Akrotiri and Dhekelia"</span>
            ,<span class="st">"?land"</span>
            ,<span class="st">"American Samoa"</span>
            ,<span class="st">"Bouvet Island"</span>
            ,<span class="st">"British Indian Ocean Territory"</span>
            ,<span class="st">"Caspian Sea"</span>
            ,<span class="st">"Christmas Island"</span>
            ,<span class="st">"Clipperton Island"</span>
            ,<span class="st">"Cocos Islands"</span>
            ,<span class="st">"Falkland Islands"</span>
            ,<span class="st">"Faroe Islands"</span>
            ,<span class="st">"French Southern Territories"</span>
            ,<span class="st">"Heard Island and McDonald Islands"</span>
            ,<span class="st">"Mayotte"</span>
            ,<span class="st">"Northern Mariana Islands"</span>
            ,<span class="st">"Paracel Islands"</span>
            ,<span class="st">"Pitcairn Islands"</span>
            ,<span class="st">"Saint Pierre and Miquelon"</span>
            ,<span class="st">"Tokelau"</span>
            ,<span class="st">"United States Minor Outlying Islands"</span>
            ,<span class="st">"Wallis and Futuna"</span>
            ,<span class="st">"United States"</span>
            ,<span class="st">"Philippines"</span>)

<span class="no">countries_summary_future_ensemble</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future_ensemble</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(!<span class="no">ID</span> <span class="kw">%in%</span> <span class="no">rems</span>)


<span class="co">#dim(countries_summary_future)</span>
<span class="no">`%notin%`</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Negate</a></span>(<span class="no">`%in%`</span>)

<span class="co"># filter(countries_summary_future, status == "native")</span>

<span class="no">countries_risk_market</span> <span class="kw">&lt;-</span> <span class="no">countries_summary_future_ensemble</span> <span class="kw">%&gt;%</span>
  <span class="fu">left_join</span>(<span class="no">countries_wine_market</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"ID"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/reexports.html">filter</a></span>(<span class="no">ID</span> <span class="kw">%notin%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"United States"</span>,
                      <span class="st">"China"</span>,
                      <span class="st">"India"</span>,
                      <span class="st">"Taiwan"</span>,
                      <span class="st">"Japan"</span>,
                      <span class="st">"South Korea"</span>,
                      <span class="st">"Vietnam"</span>))<span class="co">#%&gt;% </span>

<span class="co">#########</span>
<span class="co"># - Use this code to check to make sure that each country only has one row</span>
<span class="co"># dim(countries_risk_market)</span>
<span class="co"># setdiff(countries_risk_market$ID,countries_summary_future$ID)</span>
<span class="co"># setdiff(countries_summary_future$ID,countries_risk_market$ID)</span>
<span class="co"># table(countries_risk_market$ID)[table(countries_risk_market$ID)&gt;1]</span>
<span class="co"># table(countries_summary_future$ID)[table(countries_summary_future$ID)&gt;1]</span></pre></body></html></div>
</div>
</div>
<div id="build-and-check-model" class="section level1">
<h1 class="hasAnchor">
<a href="#build-and-check-model" class="anchor"></a>Build and check model</h1>
<p>From here, we now can build (or rebuild, technically, <code>vignette-021-quadrant-plots</code> does this first part as well) the risk model (<code>risk_mod</code>). This model is a linear regression model of log-transformed <strong>impact</strong> potential on the log-transformed <strong>transport</strong> and normal <strong>establishment</strong> potentials. We then evaluated the strength of the correlation between the empirical and predicted <strong>impact</strong> potential before conducting some diagnostics.</p>
<p>We then rescaled the predicted <strong>impact</strong> values to be bounded <span class="math inline">\([1,10]\)</span> to produce initial <code>risk</code> values.</p>
<p>To create the initial <em>shock model</em> (<code>shock_mod</code>) and ultimately obtain a scaled measure of risk of <strong>SLF</strong> to shock the global wine market, we performed linear regression of the <code>market_size</code> data on <code>risk</code> for countries and conducted diagnostics as for <code>risk_mod</code>. We then evaluated the unscaled and scaled correlations between <code>market_size</code> and <code>risk</code> for countries, resulting in a severity of risk at <span class="math inline">\(8\)</span> based on a scale of <span class="math inline">\([1,10]\)</span>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">risk_mod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">log10_avg_prod</span> ~ <span class="no">log10_avg_infected_mass</span> + <span class="no">grand_mean_max</span>,
               <span class="kw">data</span> <span class="kw">=</span> <span class="no">countries_risk_market</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">countries_risk_market</span>$<span class="no">log10_avg_prod</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">risk_mod</span>), <span class="kw">method</span> <span class="kw">=</span> <span class="st">"spearman"</span>)
<span class="co">#&gt; Warning in cor.test.default(countries_risk_market$log10_avg_prod,</span>
<span class="co">#&gt; predict(risk_mod), : Cannot compute exact p-value with ties</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Spearman's rank correlation rho</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  countries_risk_market$log10_avg_prod and predict(risk_mod)</span>
<span class="co">#&gt; S = 636279, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true rho is not equal to 0</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       rho </span>
<span class="co">#&gt; 0.6557349</span>

<span class="co">## diagnostics</span>
<span class="co"># fit is good for the multivariate correlation because there is no dispersion, but do not use this model for prediction (which I do not know why you would)</span>
<span class="no">simulationOutput_r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/simulateResiduals.html">simulateResiduals</a></span>(<span class="kw">fittedModel</span> <span class="kw">=</span> <span class="no">risk_mod</span>, <span class="kw">plot</span> <span class="kw">=</span> <span class="no">T</span>)</pre></body></html></div>
<p><img src="vignette-041-market-plot_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/testDispersion.html">testDispersion</a></span>(<span class="no">simulationOutput_r</span>)</pre></body></html></div>
<p><img src="vignette-041-market-plot_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
<pre><code><a href="https://rdrr.io/r/base/summary.html">#&gt; 
#&gt;  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
#&gt;  simulated
#&gt; 
#&gt; data:  simulationOutput
#&gt; ratioObsSim = 1.001, p-value = 0.992
#&gt; alternative hypothesis: two.sided
summary(risk_mod)
#&gt; 
#&gt; Call:
#&gt; lm(formula = log10_avg_prod ~ log10_avg_infected_mass + grand_mean_max, 
#&gt;     data = countries_risk_market)
#&gt; 
#&gt; Residuals:
#&gt;     Min      1Q  Median      3Q     Max 
#&gt; -4.0652 -1.1563 -0.1541  1.3108  4.8646 
#&gt; 
#&gt; Coefficients:
#&gt;                         Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)             -1.11406    0.27018  -4.123 5.29e-05 ***
#&gt; log10_avg_infected_mass  0.36901    0.06819   5.411 1.63e-07 ***
#&gt; grand_mean_max           3.79388    0.43887   8.645 1.13e-15 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Residual standard error: 1.806 on 220 degrees of freedom
#&gt; Multiple R-squared:  0.4331, Adjusted R-squared:  0.4279 
#&gt; F-statistic: 84.03 on 2 and 220 DF,  p-value: &lt; 2.2e-16

countries_risk_market &lt;- countries_risk_market %&gt;%
  mutate(risk = scales::rescale(predict(risk_mod), to = c(1,10)))

shock_mod &lt;- lm(market_size ~ risk, data = countries_risk_market)
summary(shock_mod)
#&gt; 
#&gt; Call:
#&gt; lm(formula = market_size ~ risk, data = countries_risk_market)
#&gt; 
#&gt; Residuals:
#&gt;     Min      1Q  Median      3Q     Max 
#&gt; -5.0037 -1.1798  0.2187  1.4528  4.1583 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)  2.02950    0.39159   5.183 6.08e-07 ***
#&gt; risk         0.54896    0.06251   8.782 1.57e-15 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Residual standard error: 1.914 on 172 degrees of freedom
#&gt;   (49 observations deleted due to missingness)
#&gt; Multiple R-squared:  0.3096, Adjusted R-squared:  0.3056 
#&gt; F-statistic: 77.13 on 1 and 172 DF,  p-value: 1.568e-15

## diagnostics
# risk estimate model fit is good and no major issues in heteroskedasticity. But I am not certain why you want this model anyways, a correlation is better because it is easily scaled betwee 1-10 
simulationOutput &lt;- simulateResiduals(fittedModel = shock_mod, plot = T) </a></code></pre>
<p><img src="vignette-041-market-plot_files/figure-html/unnamed-chunk-2-3.png" width="672"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/testDispersion.html">testDispersion</a></span>(<span class="no">simulationOutput</span>)</pre></body></html></div>
<p><img src="vignette-041-market-plot_files/figure-html/unnamed-chunk-2-4.png" width="672"></p>
<pre><code><a href="https://rdrr.io/r/stats/cor.test.html">#&gt; 
#&gt;  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
#&gt;  simulated
#&gt; 
#&gt; data:  simulationOutput
#&gt; ratioObsSim = 1.0016, p-value = 0.992
#&gt; alternative hypothesis: two.sided

cor.test(countries_risk_market$market_size, countries_risk_market$risk)
#&gt; 
#&gt;  Pearson's product-moment correlation
#&gt; 
#&gt; data:  countries_risk_market$market_size and countries_risk_market$risk
#&gt; t = 8.7824, df = 172, p-value = 1.568e-15
#&gt; alternative hypothesis: true correlation is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  0.4444373 0.6512759
#&gt; sample estimates:
#&gt;       cor 
#&gt; 0.5564175
(shock_cor &lt;- cor(countries_risk_market$market_size, 
                 countries_risk_market$risk,
                 use = "complete.obs") %&gt;% 
  scales::rescale(to = c(1,10), from = c(-1,1)) %&gt;%
  round())
#&gt; [1] 8</a></code></pre>
</div>
<div id="plotting-risk-vs-market-scatter" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-risk-vs-market-scatter" class="anchor"></a>Plotting risk vs market scatter</h1>
<p>With the predicted <strong>risk</strong>, we were able plot the scaled <code>risk</code> and <code>market_size</code>, resulting in the published risk of <strong>SLF</strong> to shock the global wine market plot.</p>
<div id="static-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#static-plot" class="anchor"></a>Static plot</h2>
<div class="sourceCode" id="cb10"><html><body><pre class="r">
<span class="co">#countries_risk_market %&gt;%</span>
<span class="co">#  mutate(risk_scale = scale(risk), market_size_scale = scale(market_size)) %&gt;%</span>
  <span class="co">#mutate(risk_scale_ticks = )</span>
<span class="co">#  ggplot(mapping = aes(x = risk_scale, </span>
<span class="co">#                       y = market_size_scale, fill = wine), color = "black") +</span>
<span class="co">#  geom_point(pch = 21)</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">remove</a></span>(<span class="no">market_scatter</span>)

<span class="no">market_scatter</span> <span class="kw">&lt;-</span> <span class="no">countries_risk_market</span> <span class="kw">%&gt;%</span>

  <span class="fu">ggplot</span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> (<span class="no">risk</span>),
                       <span class="kw">y</span> <span class="kw">=</span> (<span class="no">market_size</span>),
                       <span class="kw">size</span> <span class="kw">=</span> <span class="no">avg_wine</span>,
                       <span class="kw">fill</span> <span class="kw">=</span> <span class="no">wine</span>)
         ) +
  <span class="fu">geom_abline</span>(<span class="kw">slope</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">geom_abline</span>(<span class="kw">slope</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">geom_abline</span>(<span class="kw">slope</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">intercept</span> <span class="kw">=</span> -<span class="fl">5</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>) +

  <span class="fu">ggtitle</span>(<span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'Spotted Lanternfly Paninvasion Risk Severity ='</span>,
                        <span class="no">shock_cor</span>,<span class="st">'of 10 (P&lt;0.005)'</span>)) +
  <span class="fu">geom_point</span>(<span class="kw">pch</span> <span class="kw">=</span> <span class="fl">21</span>) +
     <span class="fu">scale_x_continuous</span>(
    <span class="kw">name</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw">expr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'Spotted Lanternfly ('</span>,<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">"Lycorma delicatula"</span>),<span class="st">') Invasion Risk'</span>)),
    <span class="kw">breaks</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">10</span>,
    <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">10</span>)
    ) +
  <span class="fu">scale_y_continuous</span>(<span class="st">"Wine Export Market Size, log10 USD"</span>,
                     <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">1</span>),
                     <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">10</span>)
                     ) +
  <span class="fu">scale_size_continuous</span>(
        <span class="co">#values = c(0,),</span>
       <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Wine Production"</span>,<span class="co"># "Wine Impact Potential",</span>
       <span class="co"># labels = c("0 t", "1.0M t", "2.0M t", "3.0M t", "4.0M t")</span>
        <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"0 t"</span>, <span class="st">"1E6 t"</span>, <span class="st">"2E6 t"</span>, <span class="st">"3E6 t"</span>, <span class="st">"4E6 t"</span>)

      ) +
 <span class="co"># scale_fill_discrete(guide = FALSE) +</span>
   <span class="fu">scale_fill_manual</span>(
         <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span> <span class="kw">=</span> <span class="st">"#ffffff"</span>, <span class="st">"yes"</span> <span class="kw">=</span> <span class="st">"#C77CFF"</span>),
         <span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>,<span class="co"># "Wine Impact Potential",</span>
         <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"wine producer"</span>, <span class="st">""</span>)
       ) +
      <span class="fu">theme</span>(
        <span class="kw">panel.grid.major</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#f0f0f0"</span>),
        <span class="kw">panel.grid.minor</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="co">#panel.grid.major = element_blank(),</span>
        <span class="co">#panel.border = element_rect(colour = "black", fill=NA, size=1),</span>
        <span class="kw">axis.line</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="co">#legend.position = c(0.7, 0.25),</span>
        <span class="co">#legend.position = "bottom",</span>
        <span class="kw">panel.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">plot.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="co">#legend.background = element_rect(colour = 'black', </span>
        <span class="co">#                                 fill = 'white', </span>
        <span class="co">#                                 linetype='solid'),</span>
        <span class="kw">axis.text</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fu">rel</span>(<span class="fl">1</span>)),
        <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">.4</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">.35</span>),
        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"plain"</span>),
        <span class="kw">legend.key.size</span> <span class="kw">=</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>),
        <span class="kw">legend.key</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="co">#plot.margin = unit(c(hh, -5, hh, hh), units = "line"),</span>
        <span class="co">#axis.title = element_text(size = rel(1.3))</span>
      ) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span>(<span class="co">#data = select(countries_risk_market,</span>
                      <span class="fu">aes</span>(<span class="co">#x = x_to_plot, </span>
                          <span class="co">#y = y_to_plot, </span>
                          <span class="kw">label</span> <span class="kw">=</span> <span class="no">ID</span>),
                      <span class="co">#label = countries_risk_market$ID,</span>
                      <span class="kw">min.segment.length</span> <span class="kw">=</span> <span class="fl">0</span>,
                      <span class="co">#direction = "x",</span>
                      <span class="co">#nudge_y = nudge.y,</span>
                      <span class="co">#nudge_x = nudge.x</span>
      <span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="co">#+</span>
  <span class="co">#guides(</span>
  <span class="co">#      fill = TRUE</span>
  <span class="co">#      ) #,</span>
      <span class="co">#   color = guide_legend(</span>
      <span class="co">#     order = 3,</span>
      <span class="co">#     override.aes = list(alpha = 1)</span>
      <span class="co">#   ),</span>
      <span class="co">#   size = guide_legend(    # Adjust size to edit legend grape production</span>
      <span class="co">#     order = 2,            # circles.</span>
      <span class="co">#     override.aes = list(size = c(1,3,6), alpha = 1)</span>
      <span class="co">#   )</span>
      <span class="co"># ) </span>

<span class="no">market_scatter</span></pre></body></html></div>
<p><img src="vignette-041-market-plot_files/figure-html/make%20scatter-1.png" width="960"></p>
</div>
<div id="interactive-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#interactive-plot" class="anchor"></a>Interactive plot</h2>
<p>We also provide an interactive version of the risk plot with <code>plotly</code>.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co">#build ggplot</span>
<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="no">countries_risk_market</span> <span class="kw">%&gt;%</span>
    <span class="fu">ggplot</span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">risk</span>,
                       <span class="kw">y</span> <span class="kw">=</span> <span class="no">market_size</span>,
                       <span class="kw">size</span> <span class="kw">=</span> <span class="no">avg_wine</span>,
                       <span class="kw">fill</span> <span class="kw">=</span> <span class="no">wine</span>,
                       <span class="kw">key</span> <span class="kw">=</span> <span class="no">ID</span>)
         ) +
  <span class="fu">geom_abline</span>(<span class="kw">slope</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">geom_abline</span>(<span class="kw">slope</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">geom_abline</span>(<span class="kw">slope</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">intercept</span> <span class="kw">=</span> -<span class="fl">5</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">geom_point</span>(<span class="kw">pch</span> <span class="kw">=</span> <span class="fl">21</span>) +
  <span class="fu">scale_fill_manual</span>(
         <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span> <span class="kw">=</span> <span class="st">"#ffffff"</span>, <span class="st">"yes"</span> <span class="kw">=</span> <span class="st">"#C77CFF"</span>),
         <span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>,
         <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"wine producer"</span>, <span class="st">""</span>)
       ) +
  <span class="fu">theme</span>(
        <span class="kw">panel.grid.major</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"#f0f0f0"</span>),
        <span class="kw">panel.grid.minor</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.line</span> <span class="kw">=</span> <span class="fu">element_line</span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">panel.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">plot.background</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
        <span class="kw">axis.text</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fu">rel</span>(<span class="fl">1</span>)),
        <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">.4</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">.35</span>),
        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"plain"</span>),
        <span class="kw">legend.key.size</span> <span class="kw">=</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>),
        <span class="kw">legend.key</span> <span class="kw">=</span> <span class="fu">element_blank</span>(),
      )

<span class="co">#execute plotly</span>
<span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="no">p1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/layout.html">layout</a></span>(<span class="kw">xaxis</span> <span class="kw">=</span>
           <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'Spotted Lanternfly'</span>,<span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(&lt;i&gt;Lycorma delicatula&lt;/i&gt;)"</span>),<span class="st">'Invasion Risk'</span>), <span class="kw">font</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">11</span>)), <span class="kw">showspikes</span> <span class="kw">=</span> <span class="no">T</span>),
         <span class="kw">yaxis</span> <span class="kw">=</span>
           <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="st">"Wine Export Market Size, log10 USD"</span>, <span class="kw">font</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">11</span>)), <span class="kw">showspikes</span> <span class="kw">=</span> <span class="no">T</span>),
         <span class="kw">title</span> <span class="kw">=</span>
           <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'Spotted Lanternfly Paninvasion Risk Severity ='</span>, <span class="no">shock_cor</span>,<span class="st">'of 10 (P&lt;0.005)'</span>),
                <span class="kw">font</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">12</span>),
                <span class="kw">x</span> <span class="kw">=</span> <span class="fl">0.1</span>,
                <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0.99</span>),
         <span class="kw">showlegend</span> <span class="kw">=</span> <span class="no">F</span>
         )</pre></body></html></div>
<div id="htmlwidget-f2c8197816c07af441f8" style="width:768px;height:768px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f2c8197816c07af441f8">{"x":{"data":[{"x":[0.55,10.45],"y":[0.55,10.45],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.55,10.45],"y":[5.55,15.45],"text":"intercept: 5<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.55,10.45],"y":[-4.45,5.45],"text":"intercept: -5<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8.11583285673119,7.92235959576373,8.04505694236236,6.63543818286781,9.06955628106199,7.6847728379615,7.28986090891298,5.2026204083692,8.85598860865758,7.45344703655419,8.38601776739563,9.19344829745789,7.28926906865975,9.86790915595461,9.30025716324966,9.42552180818807,9.13470717080869,4.7480815490417,6.16962803368788,4.87441565451056,3.84626956835503,8.41735012672427,10,8.24227799018209,9.0407453649146,8.03241158588104,7.39729100120391,3.89328306033341,6.33259249454441,9.88012124037883,5.91357034738963,7.41182520412577,6.79414914173345,5.42911851864619,7.8605048410324,4.59734586197562,5.4494626228305,7.02935369402685,7.06652588851395,6.36219955932471,9.01203995055233,6.63595037645242,7.54237986819952,8.60329991900175,8.79590576288897,6.82368810238138,6.46186321985359,4.05405589783554,8.52918765251094,8.92067951492819,6.42396675777476,7.97884053698311,7.21337173510507,7.99320899011557,8.52085110460732,8.02042261622776,9.32625828367303,9.19288576627085,6.19101539921223,7.75092953522573,9.70359585010758,6.58355720503565,8.43048936273872,9.90184858908246,7.51906130593696,6.3660171392687,6.31431901072897],"y":[4.81534965670213,5.87232154261056,8.92879140845094,6.74066285942585,9.25234764852042,8.25734869542855,6.73188893044063,6.60063363490708,8.20488694735788,4.6764657716465,6.51241381144992,6.84512863551063,7.67285439548797,7.78030073996611,9.27286189239097,2.51055157391383,7.14916788827986,4.41122758069721,6.2457944630025,3.42122823728859,7.29648947687629,5.02512655612591,9.99314495468643,8.07404764393517,9.07169747118983,7.90801871606228,7.94014779619627,5.21046765444426,7.56256728394933,9.8035388860209,5.17497180583101,5.63107687763355,5.26824331047811,8.22894924318314,7.19414896817437,null,8.22765650377449,7.4577678023506,5.92255058221976,6.02491952902964,6.74724885265277,8.08347241031293,7.25438200336692,6.97276990059108,9.03615026628654,6.81268281075248,3.96399460174006,1.94151662393378,5.99020065691098,8.94821530206465,null,7.36452977735435,7.22967047033806,7.28238976971628,7.16406019964399,8.86616210001691,9.49864344675791,8.11960604292294,null,6.55880562501787,7.01483087194452,1.00014469249311,7.61492282096138,8.8352616610214,7.05933900402251,6.57891820820866,4.74927308710924],"text":["risk:  8.115833<br />market_size: 4.8153497<br />avg_wine:   30833.3333<br />wine: yes<br />ID: Albania","risk:  7.922360<br />market_size: 5.8723215<br />avg_wine:   50333.3333<br />wine: yes<br />ID: Algeria","risk:  8.045057<br />market_size: 8.9287914<br />avg_wine: 1387595.0000<br />wine: yes<br />ID: Argentina","risk:  6.635438<br />market_size: 6.7406629<br />avg_wine:    6134.6667<br />wine: yes<br />ID: Armenia","risk:  9.069556<br />market_size: 9.2523476<br />avg_wine: 1214424.6667<br />wine: yes<br />ID: Australia","risk:  7.684773<br />market_size: 8.2573487<br />avg_wine:  218179.6667<br />wine: yes<br />ID: Austria","risk:  7.289861<br />market_size: 6.7318889<br />avg_wine:    8386.6667<br />wine: yes<br />ID: Azerbaijan","risk:  5.202620<br />market_size: 6.6006336<br />avg_wine:   28430.0000<br />wine: yes<br />ID: Belarus","risk:  8.855989<br />market_size: 8.2048869<br />avg_wine:    2888.0000<br />wine: yes<br />ID: Belgium","risk:  7.453447<br />market_size: 4.6764658<br />avg_wine:    8582.0000<br />wine: yes<br />ID: Bolivia","risk:  8.386018<br />market_size: 6.5124138<br />avg_wine:    4916.0000<br />wine: yes<br />ID: Bosnia and Herzegovina","risk:  9.193448<br />market_size: 6.8451286<br />avg_wine:  280966.6667<br />wine: yes<br />ID: Brazil","risk:  7.289269<br />market_size: 7.6728544<br />avg_wine:  131566.6667<br />wine: yes<br />ID: Bulgaria","risk:  9.867909<br />market_size: 7.7803007<br />avg_wine:   62141.3333<br />wine: yes<br />ID: Canada","risk:  9.300257<br />market_size: 9.2728619<br />avg_wine: 1250488.6667<br />wine: yes<br />ID: Chile","risk:  9.425522<br />market_size: 2.5105516<br />avg_wine:   12349.0000<br />wine: yes<br />ID: Colombia","risk:  9.134707<br />market_size: 7.1491679<br />avg_wine:   46344.6667<br />wine: yes<br />ID: Croatia","risk:  4.748082<br />market_size: 4.4112276<br />avg_wine:   12033.3333<br />wine: yes<br />ID: Cuba","risk:  6.169628<br />market_size: 6.2457945<br />avg_wine:   10671.6667<br />wine: yes<br />ID: Cyprus","risk:  4.874416<br />market_size: 3.4212282<br />avg_wine:    4666.6667<br />wine: yes<br />ID: Egypt","risk:  3.846270<br />market_size: 7.2964895<br />avg_wine:   10465.0000<br />wine: yes<br />ID: Estonia","risk:  8.417350<br />market_size: 5.0251266<br />avg_wine:    1275.0000<br />wine: yes<br />ID: Ethiopia","risk: 10.000000<br />market_size: 9.9931450<br />avg_wine: 4265552.0000<br />wine: yes<br />ID: France","risk:  8.242278<br />market_size: 8.0740476<br />avg_wine:   97100.0000<br />wine: yes<br />ID: Georgia","risk:  9.040745<br />market_size: 9.0716975<br />avg_wine:  887433.3333<br />wine: yes<br />ID: Germany","risk:  8.032412<br />market_size: 7.9080187<br />avg_wine:  313124.6667<br />wine: yes<br />ID: Greece","risk:  7.397291<br />market_size: 7.9401478<br />avg_wine:  259088.6667<br />wine: yes<br />ID: Hungary","risk:  3.893283<br />market_size: 5.2104677<br />avg_wine:       0.0000<br />wine: yes<br />ID: Iceland","risk:  6.332592<br />market_size: 7.5625673<br />avg_wine:    5000.0000<br />wine: yes<br />ID: Israel","risk:  9.880121<br />market_size: 9.8035389<br />avg_wine: 4375847.6667<br />wine: yes<br />ID: Italy","risk:  5.913570<br />market_size: 5.1749718<br />avg_wine:     479.6667<br />wine: yes<br />ID: Jordan","risk:  7.411825<br />market_size: 5.6310769<br />avg_wine:   19466.6667<br />wine: yes<br />ID: Kazakhstan","risk:  6.794149<br />market_size: 5.2682433<br />avg_wine:    1588.0000<br />wine: yes<br />ID: Kyrgyzstan","risk:  5.429119<br />market_size: 8.2289492<br />avg_wine:    2283.3333<br />wine: yes<br />ID: Latvia","risk:  7.860505<br />market_size: 7.1941490<br />avg_wine:   14800.0000<br />wine: yes<br />ID: Lebanon","risk:  4.597346<br />market_size:        NA<br />avg_wine:      78.0000<br />wine: yes<br />ID: Liechtenstein","risk:  5.449463<br />market_size: 8.2276565<br />avg_wine:    6075.6667<br />wine: yes<br />ID: Lithuania","risk:  7.029354<br />market_size: 7.4577678<br />avg_wine:   10362.3333<br />wine: yes<br />ID: Luxembourg","risk:  7.066526<br />market_size: 5.9225506<br />avg_wine:    8366.6667<br />wine: yes<br />ID: Madagascar","risk:  6.362200<br />market_size: 6.0249195<br />avg_wine:    2457.3333<br />wine: yes<br />ID: Malta","risk:  9.012040<br />market_size: 6.7472489<br />avg_wine:   39972.6667<br />wine: yes<br />ID: Mexico","risk:  6.635950<br />market_size: 8.0834724<br />avg_wine:  152116.6667<br />wine: yes<br />ID: Moldova","risk:  7.542380<br />market_size: 7.2543820<br />avg_wine:   16473.3333<br />wine: yes<br />ID: Montenegro","risk:  8.603300<br />market_size: 6.9727699<br />avg_wine:   36166.6667<br />wine: yes<br />ID: Morocco","risk:  8.795906<br />market_size: 9.0361503<br />avg_wine:  254266.6667<br />wine: yes<br />ID: New Zealand","risk:  6.823688<br />market_size: 6.8126828<br />avg_wine:       0.0000<br />wine: yes<br />ID: Norway","risk:  6.461863<br />market_size: 3.9639946<br />avg_wine:     121.6667<br />wine: yes<br />ID: Panama","risk:  4.054056<br />market_size: 1.9415166<br />avg_wine:    1443.3333<br />wine: yes<br />ID: Paraguay","risk:  8.529188<br />market_size: 5.9902007<br />avg_wine:   69333.3333<br />wine: yes<br />ID: Peru","risk:  8.920680<br />market_size: 8.9482153<br />avg_wine:  609602.0000<br />wine: yes<br />ID: Portugal","risk:  6.423967<br />market_size:        NA<br />avg_wine:      30.0000<br />wine: yes<br />ID: Reunion","risk:  7.978841<br />market_size: 7.3645298<br />avg_wine:  408257.3333<br />wine: yes<br />ID: Romania","risk:  7.213372<br />market_size: 7.2296705<br />avg_wine:  215422.0000<br />wine: yes<br />ID: Serbia","risk:  7.993209<br />market_size: 7.2823898<br />avg_wine:   33994.3333<br />wine: yes<br />ID: Slovakia","risk:  8.520851<br />market_size: 7.1640602<br />avg_wine:   20076.3333<br />wine: yes<br />ID: Slovenia","risk:  8.020423<br />market_size: 8.8661621<br />avg_wine: 1100339.0000<br />wine: yes<br />ID: South Africa","risk:  9.326258<br />market_size: 9.4986434<br />avg_wine: 4109320.0000<br />wine: yes<br />ID: Spain","risk:  9.192886<br />market_size: 8.1196060<br />avg_wine:   92538.3333<br />wine: yes<br />ID: Switzerland","risk:  6.191015<br />market_size:        NA<br />avg_wine:     150.3333<br />wine: yes<br />ID: Tajikistan","risk:  7.750930<br />market_size: 6.5588056<br />avg_wine:   27567.6667<br />wine: yes<br />ID: Tunisia","risk:  9.703596<br />market_size: 7.0148309<br />avg_wine:   35772.3333<br />wine: yes<br />ID: Turkey","risk:  6.583557<br />market_size: 1.0001447<br />avg_wine:   39000.0000<br />wine: yes<br />ID: Turkmenistan","risk:  8.430489<br />market_size: 7.6149228<br />avg_wine:  144951.3333<br />wine: yes<br />ID: Ukraine","risk:  9.901849<br />market_size: 8.8352617<br />avg_wine:     689.6667<br />wine: yes<br />ID: United Kingdom","risk:  7.519061<br />market_size: 7.0593390<br />avg_wine:   79389.3333<br />wine: yes<br />ID: Uruguay","risk:  6.366017<br />market_size: 6.5789182<br />avg_wine:   36450.0000<br />wine: yes<br />ID: Uzbekistan","risk:  6.314319<br />market_size: 4.7492731<br />avg_wine:    1750.0000<br />wine: yes<br />ID: Zimbabwe"],"key":["Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Belarus","Belgium","Bolivia","Bosnia and Herzegovina","Brazil","Bulgaria","Canada","Chile","Colombia","Croatia","Cuba","Cyprus","Egypt","Estonia","Ethiopia","France","Georgia","Germany","Greece","Hungary","Iceland","Israel","Italy","Jordan","Kazakhstan","Kyrgyzstan","Latvia","Lebanon","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malta","Mexico","Moldova","Montenegro","Morocco","New Zealand","Norway","Panama","Paraguay","Peru","Portugal","Reunion","Romania","Serbia","Slovakia","Slovenia","South Africa","Spain","Switzerland","Tajikistan","Tunisia","Turkey","Turkmenistan","Ukraine","United Kingdom","Uruguay","Uzbekistan","Zimbabwe"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":1,"size":[5.36583244671906,5.80629663666423,14.4211485336638,4.48710162753566,13.7349963040845,7.99924684055565,4.6068429701786,5.3027553446873,4.26501166668681,4.61642199109665,4.41293383253593,8.56807531434783,7.05632321484776,6.03151885222609,13.8817354931524,4.78343186883457,5.72433364451752,4.77051784399518,4.71276584872034,4.39666204221112,4.70368515973709,4.10210316053687,22.4374826621783,6.59457707458585,12.2898162373479,8.83468939672736,8.37786281174152,3.77952755905512,4.41832243751787,22.6771653543307,3.97738217780731,5.03996768245685,4.13952687239874,4.21120671790184,4.87855182374664,3.85931301380286,4.48369086923568,4.69914077207006,4.60585591624457,4.22735268763716,5.58569489682675,7.30295087104376,4.93901798383655,5.49755725024988,8.33487113512845,3.77952755905512,3.87917410016045,4.12273740962554,6.15827023147755,10.8329454479476,3.8290083975737,9.55175480735707,7.97249461486969,5.44516198207598,5.05955306120656,13.2558466586979,22.0926080513902,6.52765747618446,3.89029294547596,5.27947633457904,5.48816554728914,5.56358456337194,7.21896591909233,4.01677199803122,6.32493612247819,5.50427373090456,4.15744370565723],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"yes","legendgroup":"yes","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[7.28167777612392,1.22452722306391,4.67258109285057,6.3033881440765,2.8067448170238,3.1114087824165,3.79857958521547,4.25551428125904,3.70309916646936,4.37424347580402,3.50453248061087,3.16014663952476,3.94078065083526,3.93321126837247,5.89499891382828,1.00372966816237,4.34901955378698,3.2241695850711,2.85771335339539,3.00534217960423,5.86275044983908,4.01703833484708,6.61109263073104,2.11372631681408,3.29941235910862,2.70911789920672,3.13189134415632,4.15684831269418,1.76130009951142,7.65971637375789,1.09450126732526,1.00783614319912,7.0766907261556,5.49810058373895,7.3331816025137,4.2734125633331,3.91750282254189,7.23972727430462,9.09548442989913,5.97262695988958,4.36499427422836,4.20347509741519,2.71959611947235,4.58713451268189,2.51743651836155,3.40754582912485,3.41993127897367,3.20394976457444,4.12914603707438,6.58505494410664,1.96916632358498,2.95018926536013,3.56990264544744,1,8.68531149530249,3.5471268263929,3.89424277303209,3.07413608693574,3.77846738856557,6.141099684898,7.2756826549799,4.91681099913683,9.15016208047745,8.27334214407371,6.83465899375784,9.01448788005345,1.71088661983257,6.48219471644992,4.86393120952551,8.37400061291568,1.65688856069087,7.09805724061852,4.09271094053644,3.71584964934794,5.02442963634184,3.79236125708837,6.27445902803246,1.05809224423931,4.79109124503871,5.90970745458334,6.60023088197133,2.78822953216625,3.19403537874524,2.23198454613518,3.36136596312303,3.74431518379962,3.55447783659908,2.22556136208943,3.19186128901076,2.16653888533857,6.36384025760084,3.63603153951713,4.74809783317846,1.28337772160831,6.04233346190418,9.10709964619955,3.96241063324972,6.374629865762,3.00738816153565,4.7121848572673,1.60860808739932,6.72448509749091,3.57302601748172,6.32470301030919,8.86985240909701,1.92042367180806,2.91963583630082,6.81892306856418,7.67881302178582,2.01141864922765,3.80164516291518,1.08228733389545,9.19782484656158,7.08299058160705,1.12708716679593,1.00781375706413,1.01504507934906,1.00982044508571,1.001161318776,1.0011479754144,3.39807580080826,5.79053464389328,2.02473164797171,6.92378810435581,3.89207427448735,2.58295762521363,3.56156878315047,4.47726759094809,3.21839428463035,2.23382435637652,5.26675400472801,1.72165284240918,4.53863224601573,7.06362392622323,4.29082764460841,3.33965199503213,1.00512133291094,4.36810280981614,6.94724379621533,6.19601060445611,7.59438526742122,5.6277507900017,2.8511805340367,3.99843674179986,3.04107049337771,4.07780781235752,2.98305833110779,1.84557812725205,7.01919241309805,5.27142523048791,1.99009708130598,5.69351543627424,8.62772539302819,1.01887402379299,6.77955081943066,4.99883305145373],"y":[3.03068262851738,null,null,4.9316498386629,null,3.92256128291329,5.70173593602076,1.92241786122322,4.26739319474252,3.70249379105584,5.49191498005373,2.66052791876561,3.97563704233678,4.44781780829723,2.12052921122704,null,5.14660416537853,4.83052658996328,null,5.70880384914063,1.00014469249311,2.0638476790089,4.72386995878779,4.77497784257691,3.70926500247758,0.600086815495864,null,null,null,3.35573968919652,null,null,7.5382019835224,1.27056395073634,8.15509468180426,2.06017536918978,2.60659139625118,6.7579179503833,4.43989088770389,4.00619256021404,3.35740544959326,3.7782236267661,5.23814219505508,7.18543888492057,null,5.04729465628311,4.59855664188276,1.73863299771243,5.78967406578172,null,null,2.44386167418949,null,0.869316498856213,5.85321561022523,null,2.02514863289957,null,4.63149751892828,null,1.01980435893664,8.59050171199502,6.60097663404573,3.57968698463179,null,6.71940317167611,null,6.22111978302845,null,5.81770182667903,null,null,null,5.42209875822165,3.32553966771793,1.50021703873966,1.83566981332912,4.6338414218174,7.7592424552396,2.01447045697644,7.62382169767413,null,2.36247864333538,null,null,null,6.04568560043812,null,3.25589282380724,null,6.62429386548656,5.95241387922091,6.84304536254747,1.8010842756895,1.80109783976144,8.42105422677712,3.98258112765277,0.790858152340225,1.35973914524886,4.02306837623013,null,3.602168551379,null,2.10056038870518,null,null,4.6091813026541,2.15923335763472,6.99094934952462,null,4.48748839831552,5.653636767422,6.70855566549335,3.64608760135673,null,3.02117257349923,3.12877941307752,3.98803216369866,null,null,3.08354314827153,null,null,null,5.51263192479888,4.30360990574839,3.30124708863621,8.64565825637572,null,2.19011466846902,3.00043407747932,null,3.30124708863621,5.24155935103613,3.52093312107979,5.05336655404942,null,4.87173294165144,7.47234841453208,4.92066766747927,4.25136738406293,7.45116539129296,1.50021703873966,5.90154035782195,3.30124708863621,4.48496826977314,null,3.00043407747932,5.92503118851634,7.25722299998221,3.47733027820177,null,4.31482954072596,null,1.65141577830225,4.90763874857229],"text":["risk:  7.281678<br />market_size: 3.0306826<br />avg_wine:       0.0000<br />wine: no<br />ID: Afghanistan","risk:  1.224527<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Åland","risk:  4.672581<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Andorra","risk:  6.303388<br />market_size: 4.9316498<br />avg_wine:       0.0000<br />wine: no<br />ID: Angola","risk:  2.806745<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Anguilla","risk:  3.111409<br />market_size: 3.9225613<br />avg_wine:       0.0000<br />wine: no<br />ID: Antigua and Barbuda","risk:  3.798580<br />market_size: 5.7017359<br />avg_wine:       0.0000<br />wine: no<br />ID: Aruba","risk:  4.255514<br />market_size: 1.9224179<br />avg_wine:       0.0000<br />wine: no<br />ID: Bahamas","risk:  3.703099<br />market_size: 4.2673932<br />avg_wine:       0.0000<br />wine: no<br />ID: Bahrain","risk:  4.374243<br />market_size: 3.7024938<br />avg_wine:       0.0000<br />wine: no<br />ID: Bangladesh","risk:  3.504532<br />market_size: 5.4919150<br />avg_wine:       0.0000<br />wine: no<br />ID: Barbados","risk:  3.160147<br />market_size: 2.6605279<br />avg_wine:       0.0000<br />wine: no<br />ID: Belize","risk:  3.940781<br />market_size: 3.9756370<br />avg_wine:       0.0000<br />wine: no<br />ID: Benin","risk:  3.933211<br />market_size: 4.4478178<br />avg_wine:       0.0000<br />wine: no<br />ID: Bermuda","risk:  5.894999<br />market_size: 2.1205292<br />avg_wine:       0.0000<br />wine: no<br />ID: Bhutan","risk:  1.003730<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Bonaire, Sint Eustatius and Saba","risk:  4.349020<br />market_size: 5.1466042<br />avg_wine:       0.0000<br />wine: no<br />ID: Botswana","risk:  3.224170<br />market_size: 4.8305266<br />avg_wine:       0.0000<br />wine: no<br />ID: British Virgin Islands","risk:  2.857713<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Brunei","risk:  3.005342<br />market_size: 5.7088038<br />avg_wine:       0.0000<br />wine: no<br />ID: Burkina Faso","risk:  5.862750<br />market_size: 1.0001447<br />avg_wine:       0.0000<br />wine: no<br />ID: Burundi","risk:  4.017038<br />market_size: 2.0638477<br />avg_wine:       0.0000<br />wine: no<br />ID: Cambodia","risk:  6.611093<br />market_size: 4.7238700<br />avg_wine:       0.0000<br />wine: no<br />ID: Cameroon","risk:  2.113726<br />market_size: 4.7749778<br />avg_wine:       0.0000<br />wine: no<br />ID: Cape Verde","risk:  3.299412<br />market_size: 3.7092650<br />avg_wine:       0.0000<br />wine: no<br />ID: Cayman Islands","risk:  2.709118<br />market_size: 0.6000868<br />avg_wine:       0.0000<br />wine: no<br />ID: Central African Republic","risk:  3.131891<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Chad","risk:  4.156848<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Comoros","risk:  1.761300<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Cook Islands","risk:  7.659716<br />market_size: 3.3557397<br />avg_wine:       0.0000<br />wine: no<br />ID: Costa Rica","risk:  1.094501<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Côte d'Ivoire","risk:  1.007836<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Curaçao","risk:  7.076691<br />market_size: 7.5382020<br />avg_wine:       0.0000<br />wine: no<br />ID: Czech Republic","risk:  5.498101<br />market_size: 1.2705640<br />avg_wine:       0.0000<br />wine: no<br />ID: Democratic Republic of the Congo","risk:  7.333182<br />market_size: 8.1550947<br />avg_wine:       0.0000<br />wine: no<br />ID: Denmark","risk:  4.273413<br />market_size: 2.0601754<br />avg_wine:       0.0000<br />wine: no<br />ID: Djibouti","risk:  3.917503<br />market_size: 2.6065914<br />avg_wine:       0.0000<br />wine: no<br />ID: Dominica","risk:  7.239727<br />market_size: 6.7579180<br />avg_wine:       0.0000<br />wine: no<br />ID: Dominican Republic","risk:  9.095484<br />market_size: 4.4398909<br />avg_wine:       0.0000<br />wine: no<br />ID: Ecuador","risk:  5.972627<br />market_size: 4.0061926<br />avg_wine:       0.0000<br />wine: no<br />ID: El Salvador","risk:  4.364994<br />market_size: 3.3574054<br />avg_wine:       0.0000<br />wine: no<br />ID: Equatorial Guinea","risk:  4.203475<br />market_size: 3.7782236<br />avg_wine:       0.0000<br />wine: no<br />ID: Eritrea","risk:  2.719596<br />market_size: 5.2381422<br />avg_wine:       0.0000<br />wine: no<br />ID: Fiji","risk:  4.587135<br />market_size: 7.1854389<br />avg_wine:       0.0000<br />wine: no<br />ID: Finland","risk:  2.517437<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: French Guiana","risk:  3.407546<br />market_size: 5.0472947<br />avg_wine:       0.0000<br />wine: no<br />ID: French Polynesia","risk:  3.419931<br />market_size: 4.5985566<br />avg_wine:       0.0000<br />wine: no<br />ID: Gabon","risk:  3.203950<br />market_size: 1.7386330<br />avg_wine:       0.0000<br />wine: no<br />ID: Gambia","risk:  4.129146<br />market_size: 5.7896741<br />avg_wine:       0.0000<br />wine: no<br />ID: Ghana","risk:  6.585055<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Gibraltar","risk:  1.969166<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Greenland","risk:  2.950189<br />market_size: 2.4438617<br />avg_wine:       0.0000<br />wine: no<br />ID: Grenada","risk:  3.569903<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Guadeloupe","risk:  1.000000<br />market_size: 0.8693165<br />avg_wine:       0.0000<br />wine: no<br />ID: Guam","risk:  8.685311<br />market_size: 5.8532156<br />avg_wine:       0.0000<br />wine: no<br />ID: Guatemala","risk:  3.547127<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Guernsey","risk:  3.894243<br />market_size: 2.0251486<br />avg_wine:       0.0000<br />wine: no<br />ID: Guinea","risk:  3.074136<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Guinea-Bissau","risk:  3.778467<br />market_size: 4.6314975<br />avg_wine:       0.0000<br />wine: no<br />ID: Guyana","risk:  6.141100<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Haiti","risk:  7.275683<br />market_size: 1.0198044<br />avg_wine:       0.0000<br />wine: no<br />ID: Honduras","risk:  4.916811<br />market_size: 8.5905017<br />avg_wine:       0.0000<br />wine: no<br />ID: Hong Kong","risk:  9.150162<br />market_size: 6.6009766<br />avg_wine:       0.0000<br />wine: no<br />ID: Indonesia","risk:  8.273342<br />market_size: 3.5796870<br />avg_wine:       0.0000<br />wine: no<br />ID: Iran","risk:  6.834659<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Iraq","risk:  9.014488<br />market_size: 6.7194032<br />avg_wine:       0.0000<br />wine: no<br />ID: Ireland","risk:  1.710887<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Isle of Man","risk:  6.482195<br />market_size: 6.2211198<br />avg_wine:       0.0000<br />wine: no<br />ID: Jamaica","risk:  4.863931<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Jersey","risk:  8.374001<br />market_size: 5.8177018<br />avg_wine:       0.0000<br />wine: no<br />ID: Kenya","risk:  1.656889<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Kiribati","risk:  7.098057<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Kosovo","risk:  4.092711<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Kuwait","risk:  3.715850<br />market_size: 5.4220988<br />avg_wine:       0.0000<br />wine: no<br />ID: Laos","risk:  5.024430<br />market_size: 3.3255397<br />avg_wine:       0.0000<br />wine: no<br />ID: Lesotho","risk:  3.792361<br />market_size: 1.5002170<br />avg_wine:       0.0000<br />wine: no<br />ID: Liberia","risk:  6.274459<br />market_size: 1.8356698<br />avg_wine:       0.0000<br />wine: no<br />ID: Libya","risk:  1.058092<br />market_size: 4.6338414<br />avg_wine:       0.0000<br />wine: no<br />ID: Macao","risk:  4.791091<br />market_size: 7.7592425<br />avg_wine:       0.0000<br />wine: no<br />ID: Macedonia","risk:  5.909707<br />market_size: 2.0144705<br />avg_wine:       0.0000<br />wine: no<br />ID: Malawi","risk:  6.600231<br />market_size: 7.6238217<br />avg_wine:       0.0000<br />wine: no<br />ID: Malaysia","risk:  2.788230<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Maldives","risk:  3.194035<br />market_size: 2.3624786<br />avg_wine:       0.0000<br />wine: no<br />ID: Mali","risk:  2.231985<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Marshall Islands","risk:  3.361366<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Martinique","risk:  3.744315<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Mauritania","risk:  3.554478<br />market_size: 6.0456856<br />avg_wine:       0.0000<br />wine: no<br />ID: Mauritius","risk:  2.225561<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Micronesia","risk:  3.191861<br />market_size: 3.2558928<br />avg_wine:       0.0000<br />wine: no<br />ID: Mongolia","risk:  2.166539<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Montserrat","risk:  6.363840<br />market_size: 6.6242939<br />avg_wine:       0.0000<br />wine: no<br />ID: Mozambique","risk:  3.636032<br />market_size: 5.9524139<br />avg_wine:       0.0000<br />wine: no<br />ID: Myanmar","risk:  4.748098<br />market_size: 6.8430454<br />avg_wine:       0.0000<br />wine: no<br />ID: Namibia","risk:  1.283378<br />market_size: 1.8010843<br />avg_wine:       0.0000<br />wine: no<br />ID: Nauru","risk:  6.042333<br />market_size: 1.8010978<br />avg_wine:       0.0000<br />wine: no<br />ID: Nepal","risk:  9.107100<br />market_size: 8.4210542<br />avg_wine:       0.0000<br />wine: no<br />ID: Netherlands","risk:  3.962411<br />market_size: 3.9825811<br />avg_wine:       0.0000<br />wine: no<br />ID: New Caledonia","risk:  6.374630<br />market_size: 0.7908582<br />avg_wine:       0.0000<br />wine: no<br />ID: Nicaragua","risk:  3.007388<br />market_size: 1.3597391<br />avg_wine:       0.0000<br />wine: no<br />ID: Niger","risk:  4.712185<br />market_size: 4.0230684<br />avg_wine:       0.0000<br />wine: no<br />ID: Nigeria","risk:  1.608608<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Niue","risk:  6.724485<br />market_size: 3.6021686<br />avg_wine:       0.0000<br />wine: no<br />ID: North Korea","risk:  3.573026<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Northern Cyprus","risk:  6.324703<br />market_size: 2.1005604<br />avg_wine:       0.0000<br />wine: no<br />ID: Oman","risk:  8.869852<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Pakistan","risk:  1.920424<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Palau","risk:  2.919636<br />market_size: 4.6091813<br />avg_wine:       0.0000<br />wine: no<br />ID: Palestina","risk:  6.818923<br />market_size: 2.1592334<br />avg_wine:       0.0000<br />wine: no<br />ID: Papua New Guinea","risk:  7.678813<br />market_size: 6.9909493<br />avg_wine:       0.0000<br />wine: no<br />ID: Poland","risk:  2.011419<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Puerto Rico","risk:  3.801645<br />market_size: 4.4874884<br />avg_wine:       0.0000<br />wine: no<br />ID: Qatar","risk:  1.082287<br />market_size: 5.6536368<br />avg_wine:       0.0000<br />wine: no<br />ID: Republic of Congo","risk:  9.197825<br />market_size: 6.7085557<br />avg_wine:       0.0000<br />wine: no<br />ID: Russia","risk:  7.082991<br />market_size: 3.6460876<br />avg_wine:       0.0000<br />wine: no<br />ID: Rwanda","risk:  1.127087<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Saint Helena","risk:  1.007814<br />market_size: 3.0211726<br />avg_wine:       0.0000<br />wine: no<br />ID: Saint Kitts and Nevis","risk:  1.015045<br />market_size: 3.1287794<br />avg_wine:       0.0000<br />wine: no<br />ID: Saint Lucia","risk:  1.009820<br />market_size: 3.9880322<br />avg_wine:       0.0000<br />wine: no<br />ID: Saint Vincent and the Grenadines","risk:  1.001161<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Saint-Barthélemy","risk:  1.001148<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Saint-Martin","risk:  3.398076<br />market_size: 3.0835431<br />avg_wine:       0.0000<br />wine: no<br />ID: Samoa","risk:  5.790535<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: San Marino","risk:  2.024732<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: São Tomé and Príncipe","risk:  6.923788<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Saudi Arabia","risk:  3.892074<br />market_size: 5.5126319<br />avg_wine:       0.0000<br />wine: no<br />ID: Senegal","risk:  2.582958<br />market_size: 4.3036099<br />avg_wine:       0.0000<br />wine: no<br />ID: Seychelles","risk:  3.561569<br />market_size: 3.3012471<br />avg_wine:       0.0000<br />wine: no<br />ID: Sierra Leone","risk:  4.477268<br />market_size: 8.6456583<br />avg_wine:       0.0000<br />wine: no<br />ID: Singapore","risk:  3.218394<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Sint Maarten","risk:  2.233824<br />market_size: 2.1901147<br />avg_wine:       0.0000<br />wine: no<br />ID: Solomon Islands","risk:  5.266754<br />market_size: 3.0004341<br />avg_wine:       0.0000<br />wine: no<br />ID: Somalia","risk:  1.721653<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: South Georgia and the South Sandwich Islands","risk:  4.538632<br />market_size: 3.3012471<br />avg_wine:       0.0000<br />wine: no<br />ID: South Sudan","risk:  7.063624<br />market_size: 5.2415594<br />avg_wine:       0.0000<br />wine: no<br />ID: Sri Lanka","risk:  4.290828<br />market_size: 3.5209331<br />avg_wine:       0.0000<br />wine: no<br />ID: Sudan","risk:  3.339652<br />market_size: 5.0533666<br />avg_wine:       0.0000<br />wine: no<br />ID: Suriname","risk:  1.005121<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Svalbard and Jan Mayen","risk:  4.368103<br />market_size: 4.8717329<br />avg_wine:       0.0000<br />wine: no<br />ID: Swaziland","risk:  6.947244<br />market_size: 7.4723484<br />avg_wine:       0.0000<br />wine: no<br />ID: Sweden","risk:  6.196011<br />market_size: 4.9206677<br />avg_wine:       0.0000<br />wine: no<br />ID: Syria","risk:  7.594385<br />market_size: 4.2513674<br />avg_wine:       0.0000<br />wine: no<br />ID: Tanzania","risk:  5.627751<br />market_size: 7.4511654<br />avg_wine:       0.0000<br />wine: no<br />ID: Thailand","risk:  2.851181<br />market_size: 1.5002170<br />avg_wine:       0.0000<br />wine: no<br />ID: Timor-Leste","risk:  3.998437<br />market_size: 5.9015404<br />avg_wine:       0.0000<br />wine: no<br />ID: Togo","risk:  3.041070<br />market_size: 3.3012471<br />avg_wine:       0.0000<br />wine: no<br />ID: Tonga","risk:  4.077808<br />market_size: 4.4849683<br />avg_wine:       0.0000<br />wine: no<br />ID: Trinidad and Tobago","risk:  2.983058<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Turks and Caicos Islands","risk:  1.845578<br />market_size: 3.0004341<br />avg_wine:       0.0000<br />wine: no<br />ID: Tuvalu","risk:  7.019192<br />market_size: 5.9250312<br />avg_wine:       0.0000<br />wine: no<br />ID: Uganda","risk:  5.271425<br />market_size: 7.2572230<br />avg_wine:       0.0000<br />wine: no<br />ID: United Arab Emirates","risk:  1.990097<br />market_size: 3.4773303<br />avg_wine:       0.0000<br />wine: no<br />ID: Vanuatu","risk:  5.693515<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Vatican City","risk:  8.627725<br />market_size: 4.3148295<br />avg_wine:       0.0000<br />wine: no<br />ID: Venezuela","risk:  1.018874<br />market_size:        NA<br />avg_wine:       0.0000<br />wine: no<br />ID: Virgin Islands, U.S.","risk:  6.779551<br />market_size: 1.6514158<br />avg_wine:       0.0000<br />wine: no<br />ID: Yemen","risk:  4.998833<br />market_size: 4.9076387<br />avg_wine:       0.0000<br />wine: no<br />ID: Zambia"],"key":["Afghanistan","Åland","Andorra","Angola","Anguilla","Antigua and Barbuda","Aruba","Bahamas","Bahrain","Bangladesh","Barbados","Belize","Benin","Bermuda","Bhutan","Bonaire, Sint Eustatius and Saba","Botswana","British Virgin Islands","Brunei","Burkina Faso","Burundi","Cambodia","Cameroon","Cape Verde","Cayman Islands","Central African Republic","Chad","Comoros","Cook Islands","Costa Rica","Côte d'Ivoire","Curaçao","Czech Republic","Democratic Republic of the Congo","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","El Salvador","Equatorial Guinea","Eritrea","Fiji","Finland","French Guiana","French Polynesia","Gabon","Gambia","Ghana","Gibraltar","Greenland","Grenada","Guadeloupe","Guam","Guatemala","Guernsey","Guinea","Guinea-Bissau","Guyana","Haiti","Honduras","Hong Kong","Indonesia","Iran","Iraq","Ireland","Isle of Man","Jamaica","Jersey","Kenya","Kiribati","Kosovo","Kuwait","Laos","Lesotho","Liberia","Libya","Macao","Macedonia","Malawi","Malaysia","Maldives","Mali","Marshall Islands","Martinique","Mauritania","Mauritius","Micronesia","Mongolia","Montserrat","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Caledonia","Nicaragua","Niger","Nigeria","Niue","North Korea","Northern Cyprus","Oman","Pakistan","Palau","Palestina","Papua New Guinea","Poland","Puerto Rico","Qatar","Republic of Congo","Russia","Rwanda","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Saint-Barthélemy","Saint-Martin","Samoa","San Marino","São Tomé and Príncipe","Saudi Arabia","Senegal","Seychelles","Sierra Leone","Singapore","Sint Maarten","Solomon Islands","Somalia","South Georgia and the South Sandwich Islands","South Sudan","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen","Swaziland","Sweden","Syria","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Turks and Caicos Islands","Tuvalu","Uganda","United Arab Emirates","Vanuatu","Vatican City","Venezuela","Virgin Islands, U.S.","Yemen","Zambia"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,255,255,1)","opacity":1,"size":3.77952755905512,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"no","legendgroup":"no","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":40.1826484018265,"l":54.7945205479452},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.55,10.45],"tickmode":"array","ticktext":["2.5","5.0","7.5","10.0"],"tickvals":[2.5,5,7.5,10],"categoryorder":"array","categoryarray":["2.5","5.0","7.5","10.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.6118721461187},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(240,240,240,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Spotted Lanternfly (<i>Lycorma delicatula<\/i>) Invasion Risk","font":{"color":"rgba(0,0,0,1)","family":"","size":11}},"hoverformat":".2f","showspikes":true},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.130433908536335,10.462797861646],"tickmode":"array","ticktext":["2.5","5.0","7.5","10.0"],"tickvals":[2.5,5,7.5,10],"categoryorder":"array","categoryarray":["2.5","5.0","7.5","10.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.6118721461187},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(240,240,240,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Wine Export Market Size, log10 USD","font":{"color":"rgba(0,0,0,1)","family":"","size":11}},"hoverformat":".2f","showspikes":true},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.891732283464567},"annotations":[{"text":"<br />avg_wine","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative","title":{"text":"Spotted Lanternfly Paninvasion Risk Severity = 8 of 10 (P<0.005)","font":{"size":12},"x":0.1,"y":0.99}},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"86d45e39f617":{"intercept":{},"slope":{},"type":"scatter"},"86d42f4b9055":{"intercept":{},"slope":{}},"86d49f0d4b5":{"intercept":{},"slope":{}},"86d4221cbc2c":{"x":{},"y":{},"size":{},"fill":{},"key":{}}},"cur_data":"86d45e39f617","visdat":{"86d45e39f617":["function (y) ","x"],"86d42f4b9055":["function (y) ","x"],"86d49f0d4b5":["function (y) ","x"],"86d4221cbc2c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="save-plot-output" class="section level1">
<h1 class="hasAnchor">
<a href="#save-plot-output" class="anchor"></a>Save plot output</h1>
<p>Here, you can set to save the scatter plot to <code>/vignettes</code> as a <code>.pdf</code> file by setting the <code>if</code> from <code>FALSE</code> to <code>TRUE</code>, as in the other vignettes. We also have a version of the data saved for the Google Earth Engine App data cleaning vignette.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="kw">if</span>(<span class="fl">FALSE</span>){
  <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(),
              <span class="st">"vignettes"</span>,
              <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"market_scatter_v3_0.pdf"</span>)),
    <span class="kw">width</span> <span class="kw">=</span> <span class="fl">8.5</span>*<span class="fl">.95</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">11</span>*<span class="fl">.95</span>)

<span class="no">market_scatter</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()

<span class="no">countries_risk</span> <span class="kw">&lt;-</span> <span class="no">countries_risk_market</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">ID</span>, <span class="no">market_size</span>, <span class="no">risk</span>)

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="no">countries_risk</span>, <span class="kw">file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(), <span class="st">"data"</span>, <span class="st">"countries_risk.rda"</span>))
}</pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicholas A. Huron, Jocelyn E. Behm, Matthew R. Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
